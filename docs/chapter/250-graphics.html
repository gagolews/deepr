<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta content="Deep R Programming" name="citation_title" />
<meta content="Marek Gagolewski" name="citation_author" />
<meta content="2023" name="citation_date" />
<meta content="2023" name="citation_publication_date" />
<meta content="https://deepr.gagolewski.com/deepr.pdf" name="citation_pdf_url" />
<meta content="https://deepr.gagolewski.com" name="citation_public_url" />
<meta content="10.5281/zenodo.7490464" name="citation_doi" />
<meta content="Deep R Programming is comprehensive course on one of the most popular languages for data science (statistical computing, graphics, machine learning, data wrangling and analytics). It introduces the base language in-depth. It is aimed at ambitious students, professionals, and researchers who would like to become independent users of this powerful environment. This textbook is a non-profit project. Its online and PDF versions are freely available at https://deepr.gagolewski.com/." name="citation_abstract" />
<meta content="summary" name="twitter:card" />
<meta content="Deep R Programming" name="twitter:title" />
<meta content="Deep R Programming" name="og:title" />
<meta content="Deep R Programming is comprehensive course on one of the most popular languages for data science (statistical computing, graphics, machine learning, data wrangling and analytics). It introduces the base language in-depth. It is aimed at ambitious students, professionals, and researchers who would like to become independent users of this powerful environment. This textbook is a non-profit project. Its online and PDF versions are freely available at https://deepr.gagolewski.com/." name="twitter:description" />
<meta content="Deep R Programming is comprehensive course on one of the most popular languages for data science (statistical computing, graphics, machine learning, data wrangling and analytics). It introduces the base language in-depth. It is aimed at ambitious students, professionals, and researchers who would like to become independent users of this powerful environment. This textbook is a non-profit project. Its online and PDF versions are freely available at https://deepr.gagolewski.com/." name="og:description" />
<meta content="gagolews/deepr" name="og:site_name" />
<meta content="https://deepr.gagolewski.com" name="og:url" />
<meta content="https://deepr.gagolewski.com/_images/cover.png" name="twitter:image" />
<meta content="https://deepr.gagolewski.com/_images/cover.png" name="og:image" />
<meta content="https://deepr.gagolewski.com" name="DC.identifier" />
<meta content="Marek Gagolewski" name="DC.publisher" />
<meta content="INDEX,FOLLOW" name="robots" />
<meta content="book" name="og:type" />
<meta content="9780645571929" name="og:book:isbn" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="14. Interfacing compiled code (**)" href="310-compiled.html" /><link rel="prev" title="12. Data frames" href="240-data-frame.html" />
        <link rel="canonical" href="https://deepr.gagolewski.com/chapter/250-graphics.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 6.2.1 and Furo 2023.03.27 -->
        <title>13. Graphics - Deep R Programming</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: red;
  --color-brand-content: #CC3333;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: #ff2b53;
  --color-brand-content: #dd3333;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: #ff2b53;
  --color-brand-content: #dd3333;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Deep R Programming</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto colour theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky">

<span class="sidebar-brand-text">
<a class="sidebar-brand" href="../index.html">Deep R Programming</a>
</span>
<div class="sidebar-brand">
An open-access textbook<br />
by <a href='https://www.gagolewski.com' style="display: contents">Marek Gagolewski</a><br />
v0.9.2.9007 (draft)
</div>
<form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">About</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.gagolewski.com/">Author</a></li>
<li class="toctree-l1"><a class="reference external" href="https://deepr.gagolewski.com/deepr.pdf">This book in PDF</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/deepr">Report bugs or typos (GitHub)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/teaching-data">Datasets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://datawranglingpy.gagolewski.com/">Data wrangling with Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Start here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="000-preface.html">Preface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deep</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="110-basics.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="120-numeric.html">2. Numeric vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="130-logical.html">3. Logical vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="140-list.html">4. Lists and attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="150-indexing.html">5. Vector indexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="160-character.html">6. Character vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="170-function.html">7. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="180-flow.html">8. Flow of execution</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deeper</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="210-design.html">9. Designing functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="220-s3.html">10. S3 classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="230-matrix.html">11. Matrices and other arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="240-data-frame.html">12. Data frames</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">13. Graphics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deepest</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="310-compiled.html">14. Interfacing compiled code (**)</a></li>
<li class="toctree-l1"><a class="reference internal" href="320-language.html">15. Unevaluated expressions (*)</a></li>
<li class="toctree-l1"><a class="reference internal" href="330-environment.html">16. Environments and evaluation (*)</a></li>
<li class="toctree-l1"><a class="reference internal" href="340-lazy.html">17. Lazy evaluation (**)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="998-changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="999-bibliography.html">References</a></li>
</ul>

</div></div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/gagolews/deepr/issues/" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto colour theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="graphics">
<span id="chap-graphics"></span><h1><span class="section-number">13. </span>Graphics<a class="headerlink" href="#graphics" title="Permalink to this heading">#</a></h1>
<blockquote>
<div><p><em>The open-access textbook</em> Deep R Programming <em>by
<a class="reference external" href="https://www.gagolewski.com/">Marek Gagolewski</a>
is, and will remain, freely available for everyone’s enjoyment
(also in <a class="reference external" href="https://deepr.gagolewski.com/deepr.pdf">PDF</a>).
It is a non-profit project. Although available online, it is a whole course,
and should be read from the beginning to the end.
Refer to the <a class="reference internal" href="000-preface.html#chap-preface"><span class="std std-ref">Preface</span></a> for general introductory remarks. Any
<a class="reference external" href="https://github.com/gagolews/deepr/issues">bug/typo reports/fixes</a>
are appreciated.
Make sure to check out the author’s other book,
<a class="reference external" href="https://datawranglingpy.gagolewski.com/"><em>Minimalist Data Wrangling with Python</em></a>
<span id="id1">[<a class="reference internal" href="999-bibliography.html#id3" title="Gagolewski, M. (2022).  Minimalist Data Wrangling with Python. Zenodo. URL: https://datawranglingpy.gagolewski.com/, DOI: 10.5281/zenodo.6451068.">26</a>]</span>.</em></p>
</div></blockquote>
<p>The R project homepage advertises our free software as an
<em>environment for statistical computing and graphics</em>.
Hence, had we not dealt with the latter use case,
our course would have been incomplete.</p>
<p>R is nowadays equipped with the two following independent (incompatible,
yet coexisting) systems for graphics generation;
see <a class="reference internal" href="#fig-graphics-systems"><span class="std std-numref">Figure 13.1</span></a>.</p>
<ol class="arabic simple">
<li><p>The (historically) newer one, <strong class="program">grid</strong>
(e.g., <span id="id2">[<a class="reference internal" href="999-bibliography.html#id44" title="Murrell, P. (2011).  R Graphics. Chapman &amp; Hall/CRC.">48</a>]</span>),
is very flexible but might seem quite complicated.
Some readers might have come across
the <strong class="program">lattice</strong> <span id="id3">[<a class="reference internal" href="999-bibliography.html#id45" title="Sarkar, D. (2008).  Lattice: Multivariate Data Visualization with R. Springer. URL: http://lmdvr.r-forge.r-project.org/.">53</a>]</span>
and <strong class="program">ggplot2</strong> <span id="id4">[<a class="reference internal" href="999-bibliography.html#id47" title="Wickham, H. (2016).  ggplot2: Elegant Graphics for Data Analysis. Springer, 2nd edition.">58</a>, <a class="reference internal" href="999-bibliography.html#id46" title="Wilkinson, L. (2005).  The Grammar of Graphics. Springer.">61</a>]</span> packages
before. They are built on top of <strong class="program">grid</strong>.</p></li>
<li><p>On the other hand, its traditional (S-style) counterpart,
<em>base</em> <strong class="program">graphics</strong> (e.g., <span id="id5">[<a class="reference internal" href="999-bibliography.html#id53" title="Becker, R.A., Chambers, J.M., and Wilks, A.R. (1988).  The New S Language: A Programming Environment for Data Analysis and Graphics. Chapman &amp; Hall.">7</a>]</span>),
is much easier to master.
It still gives their users complete control over the drawing process.
It is simple, fast, and minimalist, which makes it very attractive
from the perspective of this course’s philosophy.</p></li>
</ol>
<p>This is why we only cover the second system here.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>All</em> figures in this book were generated using <strong class="program">graphics</strong>
and its dependants. They are <em>sufficiently</em> aesthetic, aren’t they?
Form precedes essence.</p>
</div>
<figure class="align-default" id="id15">
<span id="fig-graphics-systems"></span><img alt="../_images/graphics-systems.png" src="../_images/graphics-systems.png" />
<figcaption>
<p><span class="caption-number">Figure 13.1 </span><span class="caption-text">Relation between the graphics subsystems.</span><a class="headerlink" href="#id15" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="graphics-primitives">
<h2><span class="section-number">13.1. </span>Graphics primitives<a class="headerlink" href="#graphics-primitives" title="Permalink to this heading">#</a></h2>
<p>In <strong class="program">graphics</strong>, we do not choose from a superfluity
of virtual objects to be placed on an abstract canvas,
letting some algorithm decide how and when to delineate them. We <em>just draw</em>.
We do so by calling functions that plot the following <em>graphics primitives</em>
(see, e.g., <span id="id6">[<a class="reference internal" href="999-bibliography.html#id56" title="Hughes, J., van Dam, A., McGuire, M., Sklar, D., Foley, J., Feiner, S., and Akeley, K. (2013).  Computer Graphics: Principles and Practice. Addison-Wesley, 3rd edition.">36</a>, <a class="reference internal" href="999-bibliography.html#id57" title="Marschner, S. and Shirley, P. (2021).  Fundamentals of Computer Graphics. AK Peters/CRC Press, 5th edition.">44</a>]</span>):</p>
<ul class="simple">
<li><p>symbols (e.g., pixels, circles, stars)
of different shapes and colours,</p></li>
<li><p>line segments of different styles (e.g., solid, dashed, dotted),</p></li>
<li><p>polygons (optionally filled),</p></li>
<li><p>text (using available fonts),</p></li>
<li><p>raster images (bitmaps).</p></li>
</ul>
<p>That’s it. It will turn out that <em>all</em> other shapes
(smooth curves, circles) may be easily approximated using the above.</p>
<p>Of course, in practice, we do not always have to be so low-level.
There are many functions that provide
the most popular chart types: histograms, bar plots,
dendrograms, etc. They will suit our basic needs.
We will review them in <a class="reference internal" href="#sec-high-level-plotting"><span class="std std-numref">Section 13.3</span></a>.</p>
<p>The more basic routines we discuss next will still be of service
for fine-tuning our figures and adding further details.
However, if the prefabricated components are not what we are after,
we will be able to create any drawing from scratch.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In <strong class="program">graphics</strong>, most of the function calls have immediate
effects. Objects are drawn on the active plot one by one,
and their state cannot be modified later.</p>
</div>
<div class="proof proof-type-example" id="id16">

    <div class="proof-title">
        <span class="proof-type">Example 13.1</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-primitives-demo"><span class="std std-numref">Figure 13.2</span></a> depicts some
graphics primitives, which we plotted using the following program.
We will detail the meaning of all the functions in the next
sections, but they should be self-explanatory enough for us to be able
to find the corresponding shapes in the plot.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span><span class="w">  </span><span class="c1"># small plot margins (bottom, left, top, right)</span>
<span class="nf">plot.new</span><span class="p">()</span><span class="w">  </span><span class="c1"># start a new plot</span>
<span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">asp</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># x range: 0–6, y: 0–2; proportional</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w">    </span><span class="m">6</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.25</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">)],</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">)])</span><span class="w">  </span><span class="c1"># symbols</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">   </span><span class="c1"># line segments</span>
<span class="nf">text</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;(0, 0)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;(6, 2)&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># two text labels</span>
<span class="nf">rasterImage</span><span class="p">(</span>
<span class="w">    </span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">  </span><span class="c1"># 2x3 pixel &quot;image&quot;; 0=black, 1=white</span>
<span class="w">             </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">             </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">),</span>
<span class="w">    </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">  </span><span class="c1"># position: xleft, ybottom, xright, ytop</span>
<span class="w">    </span><span class="n">interpolate</span><span class="o">=</span><span class="kc">FALSE</span>
<span class="p">)</span>
<span class="nf">polygon</span><span class="p">(</span>
<span class="w">    </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">5.5</span><span class="p">,</span><span class="w">    </span><span class="m">4</span><span class="p">),</span><span class="w">  </span><span class="c1"># x coordinates of the vertices</span>
<span class="w">    </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">   </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.75</span><span class="p">),</span><span class="w">  </span><span class="c1"># y coordinates</span>
<span class="w">    </span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dotted&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># border style</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;#ffff0044&quot;</span><span class="w">  </span><span class="c1"># fill colour: semi-transparent yellow</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id17">
<span id="fig-primitives-demo"></span><img alt="../_images/primitives-demo-1.png" src="../_images/primitives-demo-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.2 </span><span class="caption-text">Graphics primitives: plotting symbols, line segments, polygons, text labels, and bitmaps. Objects are added one after another, with newer ones drawn <em>over</em> the already existing shapes.</span><a class="headerlink" href="#id17" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><section id="symbols-points">
<h3><span class="section-number">13.1.1. </span>Symbols (points)<a class="headerlink" href="#symbols-points" title="Permalink to this heading">#</a></h3>
<p>The <strong class="command">points</strong> function can draw a series
of symbols (by default, circles) on the two-dimensional
plot region, relative to the user coordinate system.</p>
<p>We specify the points’ coordinates using the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> arguments
(two vectors of equal lengths; no recycling).
Alternatively, we may give a matrix or a data frame with two columns:
its first column (regardless of how and if it is named)
defines the abscissae, and the second column determines the ordinates.</p>
<p>This function permits us to plot each point differently if this
is what we desire. Thus, it is ideal for drawing scatter plots,
possibly for grouped data (see <a class="reference internal" href="#fig-irisplot-factors"><span class="std std-numref">Figure 13.17</span></a> below).
It is vectorised with respect to, amongst others,
the <code class="docutils literal notranslate"><span class="pre">col</span></code> (colour; see <a class="reference internal" href="#sec-colours"><span class="std std-numref">Section 13.2.1</span></a>), <code class="docutils literal notranslate"><span class="pre">cex</span></code> (scale, defaults to 1),
and <code class="docutils literal notranslate"><span class="pre">pch</span></code> (plotting character or symbol, defaults to 1, i.e., a circle)
arguments.</p>
<div class="proof proof-type-example" id="id18">

    <div class="proof-title">
        <span class="proof-type">Example 13.2</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-pch"><span class="std std-numref">Figure 13.3</span></a> gives an overview of the plotting symbols available.
The most often used ones are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NA_integer_</span></code> – no symbol,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code>, …, <code class="docutils literal notranslate"><span class="pre">14</span></code> and <code class="docutils literal notranslate"><span class="pre">15</span></code>, …, <code class="docutils literal notranslate"><span class="pre">18</span></code> – unfilled and filled symbols,
respectively;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">19</span></code>, …, <code class="docutils literal notranslate"><span class="pre">25</span></code> – filled symbols with a border of width <code class="docutils literal notranslate"><span class="pre">lwd</span></code>;
for codes <code class="docutils literal notranslate"><span class="pre">21</span></code>, …, <code class="docutils literal notranslate"><span class="pre">25</span></code>, the fill colour is controlled separately
by the <code class="docutils literal notranslate"><span class="pre">bg</span></code> parameter,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;.&quot;</span></code> – a tiny point (a “pixel”),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code>, etc. – a single character (not all Unicode characters
can be drawn); strings longer than one will be truncated.</p></li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="w"> </span><span class="m">9.1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="w"> </span><span class="m">4.1</span><span class="p">))</span>
<span class="nf">points</span><span class="p">(</span>
<span class="w">    </span><span class="nf">cbind</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w">  </span><span class="c1"># or x=1:9, y=rep(1, 9); bottom row</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">pch</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Spanish Inquisition&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;!&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;9&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">xy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">expand.grid</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="o">:</span><span class="m">2</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="m">0</span><span class="o">:</span><span class="p">(</span><span class="nf">NROW</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span><span class="m">-1</span><span class="p">),</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">0.89</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="o">=</span><span class="m">0.75</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;darkgray&quot;</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">0</span><span class="o">:</span><span class="p">(</span><span class="nf">NROW</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span><span class="m">-1</span><span class="p">),</span><span class="w"> </span><span class="n">bg</span><span class="o">=</span><span class="s">&quot;yellow&quot;</span><span class="p">)</span>
<span class="c1">## Warning in plot.xy(xy.coords(x, y), type = type, ...): unimplemented pch</span>
<span class="c1">##     value &#39;26&#39;</span>
</pre></div>
</div>
<figure class="align-default" id="id19">
<span id="fig-pch"></span><img alt="../_images/pch-1.png" src="../_images/pch-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.3 </span><span class="caption-text">Plotting characters and symbols (<code class="docutils literal notranslate"><span class="pre">pch</span></code>).</span><a class="headerlink" href="#id19" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div></section>
<section id="line-segments">
<h3><span class="section-number">13.1.2. </span>Line segments<a class="headerlink" href="#line-segments" title="Permalink to this heading">#</a></h3>
<p><strong class="command">lines</strong> can draw connected line segments
whose mid- and endpoints are given in a similar manner as in
the <strong class="command">points</strong> function.
A series of segments can be interrupted by defining an endpoint
whose coordinate is a missing value; compare <a class="reference internal" href="#fig-primitives-demo"><span class="std std-numref">Figure 13.2</span></a>.</p>
<p>Actually, <strong class="command">points</strong> and <strong class="command">lines</strong> are wrappers around the same function, <strong class="command">plot.xy</strong>, which we usually do not call directly.
Their <code class="docutils literal notranslate"><span class="pre">type</span></code> arguments determine the object to draw;
the only difference is that by default the former uses <code class="docutils literal notranslate"><span class="pre">type=&quot;p&quot;</span></code>
whilst the latter relies on <code class="docutils literal notranslate"><span class="pre">type=&quot;l&quot;</span></code> .
Changing these to <code class="docutils literal notranslate"><span class="pre">type=&quot;b&quot;</span></code> (both) or <code class="docutils literal notranslate"><span class="pre">type=&quot;o&quot;</span></code> (overplot) will give
their combination. Moreover, <code class="docutils literal notranslate"><span class="pre">type=&quot;s&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">type=&quot;S&quot;</span></code> creates step
functions (with post- and pre-increments, respectively),
and <code class="docutils literal notranslate"><span class="pre">type=&quot;h&quot;</span></code> draws bar plot-like vertical lines.
See <a class="reference internal" href="#fig-line-type"><span class="std std-numref">Figure 13.4</span></a> for an illustration
(implement something similar yourself as an exercise).</p>
<figure class="align-default" id="id20">
<span id="fig-line-type"></span><img alt="../_images/line-type-1.png" src="../_images/line-type-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.4 </span><span class="caption-text">Different <code class="docutils literal notranslate"><span class="pre">type</span></code> argument settings in <strong class="command">lines</strong> or <strong class="command">points</strong>.</span><a class="headerlink" href="#id20" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The <code class="docutils literal notranslate"><span class="pre">col</span></code> argument controls the line colour (see <a class="reference internal" href="#sec-colours"><span class="std std-numref">Section 13.2.1</span></a>),
and <code class="docutils literal notranslate"><span class="pre">lwd</span></code> determines the line width (1 by default). Six named line types
(<code class="docutils literal notranslate"><span class="pre">lty</span></code>) are available, which can also be specified via their respective
numeric identifiers, <code class="docutils literal notranslate"><span class="pre">lty=1</span></code>, …, <code class="docutils literal notranslate"><span class="pre">lty=6</span></code>; see <a class="reference internal" href="#fig-lty"><span class="std std-numref">Figure 13.5</span></a>
(implementing a similar plot is left as an exercise). Additionally, custom
dashes can be defined using strings of up to eight hexadecimal digits.
Consecutive digits give the lengths of the dashes and blanks (alternating).
For instance, <code class="docutils literal notranslate"><span class="pre">lty=&quot;1343&quot;</span></code> yields a dash of length 1, followed by a space of
length 3, then a dash of length 4, followed by a blank of length 3.
The whole sequence will be recycled for as long as necessary.</p>
<figure class="align-default" id="id21">
<span id="fig-lty"></span><img alt="../_images/lty-1.png" src="../_images/lty-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.5 </span><span class="caption-text">Line types (<code class="docutils literal notranslate"><span class="pre">lty</span></code>).</span><a class="headerlink" href="#id21" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="proof proof-type-example" id="id22">

    <div class="proof-title">
        <span class="proof-type">Example 13.3</span>
        
    </div><div class="proof-content">
<p><strong class="command">lines</strong> can be used for plotting empirical cumulative
distribution functions (we will suggest it as an exercise later),
regression models (e.g., lines, splines of different degrees),
time series, and any other mathematical functions, even when they are smooth
and <em>curvy</em>. The naked eye cannot tell the difference between a densely
sampled piecewise linear approximation of an object and its original version.
The code below illustrates this (sad for the high-hearted idealists)
truth using the <em>sine</em> function; see <a class="reference internal" href="#fig-sampling"><span class="std std-numref">Figure 13.6</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ns</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">seq</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">*</span><span class="kc">pi</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">ns</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">((</span><span class="n">i</span><span class="m">-1</span><span class="p">)</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">    </span><span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">text</span><span class="p">((</span><span class="n">i</span><span class="m">-0.5</span><span class="p">)</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">0.89</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<figure class="align-default" id="id23">
<span id="fig-sampling"></span><img alt="../_images/sampling-1.png" src="../_images/sampling-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.6 </span><span class="caption-text">The sine function approximated with line segments. Sampling more densely gives the illusion of smoothness.</span><a class="headerlink" href="#id23" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-exercise" id="id24">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.4</span>
        
    </div><div class="proof-content">
<p>Implement your version of the <strong class="command">segments</strong> function
using a call to <strong class="command">lines</strong>.</p>
</div></div><div class="proof proof-type-exercise" id="id25">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.5</span>
        
    </div><div class="proof-content">
<p>(*) Implement a simplified version of the <strong class="command">arrows</strong> function,
where the length of edges of the arrowhead is given in user coordinates
(and not inches; you will be equipped with skills to achieve this
later; see <a class="reference internal" href="#sec-plot-inch"><span class="std std-numref">Section 13.2.4</span></a>).
Use the <code class="docutils literal notranslate"><span class="pre">ljoin</span></code> and <code class="docutils literal notranslate"><span class="pre">lend</span></code> arguments (see <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;par&quot;)</span></code> for admissible values)
to change the line end and join styles (from the default rounded caps).</p>
</div></div></section>
<section id="polygons">
<h3><span class="section-number">13.1.3. </span>Polygons<a class="headerlink" href="#polygons" title="Permalink to this heading">#</a></h3>
<p><strong class="command">polygon</strong> draws a polygon with a border of specified
colour and line type (<code class="docutils literal notranslate"><span class="pre">border</span></code>, <code class="docutils literal notranslate"><span class="pre">lty</span></code>, <code class="docutils literal notranslate"><span class="pre">lwd</span></code>).
If the <code class="docutils literal notranslate"><span class="pre">col</span></code> argument is not missing, the polygon is filled
(or hatched; cf. the <code class="docutils literal notranslate"><span class="pre">density</span></code> and <code class="docutils literal notranslate"><span class="pre">angle</span></code> arguments).</p>
<div class="proof proof-type-example" id="id26">

    <div class="proof-title">
        <span class="proof-type">Example 13.6</span>
        
    </div><div class="proof-content">
<p>Let us draw a few regular (equilateral
and equiangular) polygons; see <a class="reference internal" href="#fig-circles"><span class="std std-numref">Figure 13.7</span></a>.
By increasing the number of sides, we can obtain an approximation
to a circle.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">regular_poly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">101</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">theta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">n</span><span class="m">+1</span><span class="p">)[</span><span class="m">-1</span><span class="p">]</span>
<span class="w">    </span><span class="nf">polygon</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="w"> </span><span class="n">y0</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">9.5</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">asp</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">regular_poly</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="nf">regular_poly</span><span class="p">(</span><span class="m">3.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">density</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">angle</span><span class="o">=</span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;tan&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="nf">regular_poly</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">density</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">angle</span><span class="o">=</span><span class="m">-60</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">regular_poly</span><span class="p">(</span><span class="m">8.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;lightyellow&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id27">
<span id="fig-circles"></span><img alt="../_images/circles-1.png" src="../_images/circles-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.7 </span><span class="caption-text">Regular polygons drawn using <strong class="command">polygon</strong>.</span><a class="headerlink" href="#id27" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Note the <code class="docutils literal notranslate"><span class="pre">asp=1</span></code> argument to the <strong class="command">plot.window</strong> function
(which we detail below) that guarantees the same scaling of the
x- and y-axes. This way, the circle looks like one and not an oval.</p>
</div></div><p>Notice that the last vertex adjoins the first one.
Also, if we are absent-minded (or particularly creative),
we can produce self-intersecting or otherwise degenerate shapes.</p>
<div class="proof proof-type-exercise" id="id28">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.7</span>
        
    </div><div class="proof-content">
<p>Implement your version of the <strong class="command">rect</strong> function
using a call to <strong class="command">polygon</strong>.</p>
</div></div></section>
<section id="text">
<h3><span class="section-number">13.1.4. </span>Text<a class="headerlink" href="#text" title="Permalink to this heading">#</a></h3>
<p>A call to <strong class="command">text</strong> draws arbitrary strings (newlines and tabs
are supported) centred at the specified points.
Moreover, by setting the <code class="docutils literal notranslate"><span class="pre">pos</span></code> argument, the labels may be placed
below, to the left of, etc., the pivots.
Some further position adjustments are also possible (<code class="docutils literal notranslate"><span class="pre">adj</span></code>, <code class="docutils literal notranslate"><span class="pre">offset</span></code>);
see <a class="reference internal" href="#fig-textdemo"><span class="std std-numref">Figure 13.8</span></a>.</p>
<figure class="align-default" id="id29">
<span id="fig-textdemo"></span><img alt="../_images/textdemo-1.png" src="../_images/textdemo-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.8 </span><span class="caption-text">The positioning of text with <strong class="command">text</strong> (plotting symbols added for reference).</span><a class="headerlink" href="#id29" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><code class="docutils literal notranslate"><span class="pre">col</span></code> specifies the colour, <code class="docutils literal notranslate"><span class="pre">cex</span></code> affects the size, and <code class="docutils literal notranslate"><span class="pre">srt</span></code>
changes the rotation of the text.</p>
<p>On many graphics devices, we have little but crude control over
the font face used: <code class="docutils literal notranslate"><span class="pre">family</span></code> chooses a generic font family
(<code class="docutils literal notranslate"><span class="pre">&quot;sans&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;serif&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mono&quot;</span></code>), and <code class="docutils literal notranslate"><span class="pre">font</span></code>
selects between the normal variant (<code class="docutils literal notranslate"><span class="pre">1</span></code>), bold (<code class="docutils literal notranslate"><span class="pre">2</span></code>),
italic (<code class="docutils literal notranslate"><span class="pre">3</span></code>), or bold italic (<code class="docutils literal notranslate"><span class="pre">4</span></code>).
See, however, <a class="reference internal" href="#sec-grdevices"><span class="std std-numref">Section 13.2.6</span></a> for some workarounds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(*) There is some limited support for basic mathematical
symbols and formulae. It relies
on some quirky syntax that we enter using unevaluated R expressions
(<a class="reference internal" href="320-language.html#chap-language"><span class="std std-numref">Chapter 15</span></a>). Still, it should be enough to meet our most basic
needs. For instance, passing <strong class="command">quote</strong><code class="code docutils literal notranslate"><span class="pre">(beta[i]^j)</span></code>
as the <code class="docutils literal notranslate"><span class="pre">labels</span></code> argument to <strong class="command">text</strong> will output “<span class="math">\(\beta_i^j\)</span>”.
See <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;plotmath&quot;)</span></code> for more details.</p>
<p>For more sophisticated mathematical typesetting, see the
<strong class="program">tikzDevice</strong> graphics device mentioned in <a class="reference internal" href="#sec-grdevices"><span class="std std-numref">Section 13.2.6</span></a>.
It outputs plot specifications that can be rendered by
the LaTeX typesetting system.</p>
</div>
</section>
<section id="raster-images-bitmaps">
<h3><span class="section-number">13.1.5. </span>Raster images (bitmaps) (*)<a class="headerlink" href="#raster-images-bitmaps" title="Permalink to this heading">#</a></h3>
<p>Raster images are encoded in the form of bitmaps, i.e., matrices
whose elements represent pixels (see <a class="reference internal" href="#fig-primitives-demo"><span class="std std-numref">Figure 13.2</span></a>
for an example). They can be used for drawing heat maps or backgrounds of
contour plots; see <a class="reference internal" href="#sec-heat-map"><span class="std std-numref">Section 13.3.4</span></a>.</p>
<div class="proof proof-type-example" id="id30">

    <div class="proof-title">
        <span class="proof-type">Example 13.8</span>
        
    </div><div class="proof-content">
<p>Optionally, bilinear interpolation
can be applied if the drawing area is larger than the true bitmap size,
and we would like to smoothen the colour transitions out.
<a class="reference internal" href="#fig-gradient"><span class="std std-numref">Figure 13.9</span></a> presents a very stretched <span class="math">\(4\times 3\)</span> pixel
image, with and without interpolation.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="n">I</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="n">nrow</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">    </span><span class="nf">c</span><span class="p">(</span><span class="w">   </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w">  </span><span class="s">&quot;white&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span><span class="w">    </span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nf">rasterImage</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># interpolate=TRUE; left subplot</span>
<span class="nf">rasterImage</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">interpolate</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">  </span><span class="c1"># right subplot</span>
</pre></div>
</div>
<figure class="align-default" id="id31">
<span id="fig-gradient"></span><img alt="../_images/gradient-1.png" src="../_images/gradient-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.9 </span><span class="caption-text">Example bitmaps drawn with <strong class="command">rasterImage</strong>, with (left) and without (right) colour interpolation.</span><a class="headerlink" href="#id31" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div></section>
</section>
<section id="graphics-settings">
<span id="sec-graphics-par"></span><h2><span class="section-number">13.2. </span>Graphics settings<a class="headerlink" href="#graphics-settings" title="Permalink to this heading">#</a></h2>
<p><strong class="command">par</strong> can be used to query and modify (as long
as they are not read-only) many graphics options.
For instance, we have several parameters related to the current page
or device settings,
e.g., the plot’s margins (see <a class="reference internal" href="#sec-plot-margins"><span class="std std-numref">Section 13.2.2</span></a>)
or user coordinates (see <a class="reference internal" href="#sec-plot-usr-axis"><span class="std std-numref">Section 13.2.3</span></a>).
The reference list of available parameters is given in <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;par&quot;)</span></code>.
Below we discuss the most noteworthy ones.</p>
<p>Moreover, some functions source<a class="footnote-reference brackets" href="#pardefexcept" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> the values of their default
arguments by querying <strong class="command">par</strong>. This is the case of,
e.g., <code class="docutils literal notranslate"><span class="pre">col</span></code>, <code class="docutils literal notranslate"><span class="pre">pch</span></code>, <code class="docutils literal notranslate"><span class="pre">lty</span></code> in the <strong class="command">points</strong> and <strong class="command">lines</strong>
function.</p>
<div class="proof proof-type-exercise" id="id32">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.9</span>
        
    </div><div class="proof-content">
<p>Study the following pseudocode.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">  </span><span class="c1"># use the default `lty`, i.e., par(&quot;lty&quot;) == &quot;solid&quot;</span>
<span class="n">old_settings</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># change setting, save old for reference</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">  </span><span class="c1"># use the new default `lty`, i.e., par(&quot;lty&quot;) == &quot;dashed&quot;</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w">  </span><span class="c1"># use the given `lty`, but only for this call</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">  </span><span class="c1"># default lty=&quot;dashed&quot; again</span>
<span class="nf">par</span><span class="p">(</span><span class="n">old_settings</span><span class="p">)</span><span class="w">  </span><span class="c1"># restore the previous settings</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">  </span><span class="c1"># lty=&quot;solid&quot; now</span>
</pre></div>
</div>
</div></div><section id="colours">
<span id="sec-colours"></span><h3><span class="section-number">13.2.1. </span>Colours<a class="headerlink" href="#colours" title="Permalink to this heading">#</a></h3>
<p>Many functions allow for customising colours of the plotted objects
or their parts; compare, e.g., <code class="docutils literal notranslate"><span class="pre">col</span></code> and <code class="docutils literal notranslate"><span class="pre">border</span></code> arguments
to <strong class="command">polygon</strong>, or <code class="docutils literal notranslate"><span class="pre">col</span></code> and <code class="docutils literal notranslate"><span class="pre">bg</span></code> to <strong class="command">points</strong>.</p>
<p>There are a few ways to specify colours
(see the <em>Colour Specification</em> section of <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;par&quot;)</span></code> for more details).</p>
<ul>
<li><p>We can use a <code class="docutils literal notranslate"><span class="pre">&quot;colour</span> <span class="pre">name&quot;</span></code> string, being one of the 657
predefined tags known to the <strong class="command">colours</strong> function:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sample</span><span class="p">(</span><span class="nf">colours</span><span class="p">(),</span><span class="w"> </span><span class="m">8</span><span class="p">)</span><span class="w">  </span><span class="c1"># this is just a sample</span>
<span></span><span class="c1">## [1] &quot;grey23&quot;        &quot;darksalmon&quot;    &quot;tan3&quot;          &quot;violetred4&quot;</span>
<span class="c1">## [5] &quot;lightblue1&quot;    &quot;darkorchid3&quot;   &quot;darkseagreen1&quot; &quot;slategray3&quot;</span>
</pre></div>
</div>
</li>
<li><p>We can pass a<code class="docutils literal notranslate"><span class="pre">&quot;#rrggbb&quot;</span></code> string, which specifies a position in the
RGB colour space: three series of hexadecimal numbers of two digits each,
i.e., between <span class="math">\(\text{00}_\text{hex}=0\)</span>
(off) and <span class="math">\(\text{FF}_\text{hex}=255\)</span> (full on),
giving the intensity of the red, green, and blue channels<a class="footnote-reference brackets" href="#footrgb" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<p>In practice, the <strong class="command">col2rgb</strong> and <strong class="command">rgb</strong> functions
can convert between the decimal and hexadecimal representations:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cyan&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;magenta&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;grey&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lightgrey&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pink&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># example colours</span>
<span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">structure</span><span class="p">(</span><span class="nf">col2rgb</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="w"> </span><span class="n">dimnames</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;R&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;G&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">C</span><span class="p">)))</span>
<span></span><span class="c1">##   black red green blue cyan magenta yellow grey lightgrey pink</span>
<span class="c1">## R     0 255     0    0    0     255    255  190       211  255</span>
<span class="c1">## G     0   0   255    0  255       0    255  190       211  192</span>
<span class="c1">## B     0   0     0  255  255     255      0  190       211  203</span>
<span></span><span class="nf">structure</span><span class="p">(</span><span class="nf">rgb</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="n">M</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="n">M</span><span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="n">maxColorValue</span><span class="o">=</span><span class="m">255</span><span class="p">),</span><span class="w"> </span><span class="n">names</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span></span><span class="c1">##     black       red     green      blue      cyan   magenta    yellow</span>
<span class="c1">## &quot;#000000&quot; &quot;#FF0000&quot; &quot;#00FF00&quot; &quot;#0000FF&quot; &quot;#00FFFF&quot; &quot;#FF00FF&quot; &quot;#FFFF00&quot;</span>
<span class="c1">##      grey lightgrey      pink</span>
<span class="c1">## &quot;#BEBEBE&quot; &quot;#D3D3D3&quot; &quot;#FFC0CB&quot;</span>
</pre></div>
</div>
</li>
<li><p>An <code class="docutils literal notranslate"><span class="pre">&quot;#rrggbbaa&quot;</span></code> string is similar, but has the added alpha channel
(two additional hexadecimal digits): from <span class="math">\(\text{00}_\text{hex}=0\)</span>
denoting fully transparent, to <span class="math">\(\text{FF}_\text{hex}=255\)</span>
indicating fully visible (lit) colour;
see <a class="reference internal" href="#fig-primitives-demo"><span class="std std-numref">Figure 13.2</span></a> for an example.</p>
<p>Semi-transparency (translucency) can significantly enhance
the expressivity of our data visualisations;
see <a class="reference internal" href="#fig-semitrans-scatter"><span class="std std-numref">Figure 13.18</span></a>
and <a class="reference internal" href="#fig-semitrans-ribbon"><span class="std std-numref">Figure 13.19</span></a>.</p>
</li>
<li><p>We can rely on an integer index to select an item from the
<em>current palette</em> (with recycling), which we can get or set by a call to
<strong class="command">palette</strong>. Moreover, <code class="docutils literal notranslate"><span class="pre">0</span></code> identifies the background colour,
<strong class="command">par</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;bg&quot;)</span></code>.</p>
<p>Integer colour specifiers are particularly valuable when plotting
data in groups defined by factor objects. The underlying integer level
codes can be mapped to consecutive colours from any palette;
see <a class="reference internal" href="#fig-irisplot-factors"><span class="std std-numref">Figure 13.17</span></a> below for an example.</p>
</li>
</ul>
<div class="proof proof-type-example" id="id33">

    <div class="proof-title">
        <span class="proof-type">Example 13.10</span>
        
    </div><div class="proof-content">
<p>We recommend memorising the colours in the default palette:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">palette</span><span class="p">()</span><span class="w">  </span><span class="c1"># default palette</span>
<span class="c1">## [1] &quot;#000000F0&quot; &quot;#DF536BF0&quot; &quot;#61D04FF0&quot; &quot;#2297E6F0&quot; &quot;#28E2E5F0&quot;</span>
<span class="c1">## [6] &quot;#CD0BBCF0&quot; &quot;#F5C710F0&quot; &quot;#999999F0&quot;</span>
</pre></div>
</div>
<p>These are<a class="footnote-reference brackets" href="#footcolourblind" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>, in order: black, red, green, blue, cyan,
magenta, yellow, and grey; see<a class="footnote-reference brackets" href="#footbwonline" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> <a class="reference internal" href="#fig-palette"><span class="std std-numref">Figure 13.10</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="nf">palette</span><span class="p">())</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">));</span><span class="w"> </span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="m">+1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="nf">points</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="nf">palette</span><span class="p">(),</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id34">
<span id="fig-palette"></span><img alt="../_images/palette-1.png" src="../_images/palette-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.10 </span><span class="caption-text">The default colour <strong class="command">palette</strong>.</span><a class="headerlink" href="#id34" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><p>Choosing usable colours requires some talents that most
programmers lack. Therefore, we will find ourselves relying
on the built-in colour sets.
<strong class="command">palette.pals</strong> and <strong class="command">hcl.pals</strong>
return the names of the available <em>discrete</em> (qualitative)
palettes. Then, <strong class="command">palette.colors</strong> and <strong class="command">hcl.colors</strong>
(note the American spelling) can generate a given number
of colours from a particular named set.</p>
<p><em>Continuous</em> (quantitative) palettes are also available,
see <strong class="command">rainbow</strong>, <strong class="command">heat.colors</strong>,
<strong class="command">terrain.colors</strong>, <strong class="command">topo.colors</strong>,
<strong class="command">cm.colors</strong>, and <strong class="command">gray.colors</strong>.
They transition smoothly between some predefined pivot colours, e.g.,
from blue through green to brown (like in a topographic map
with elevation colouring).
They may be of use, e.g., when drawing contour plots;
compare <a class="reference internal" href="#fig-contour"><span class="std std-numref">Figure 13.27</span></a>.</p>
<div class="proof proof-type-exercise" id="id35">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.11</span>
        
    </div><div class="proof-content">
<p>Create a demo of the aforementioned palettes
in a similar (or nicer) style to that in <a class="reference internal" href="#fig-palette-pals"><span class="std std-numref">Figure 13.11</span></a>.</p>
<figure class="align-default" id="id36">
<span id="fig-palette-pals"></span><img alt="../_images/palette-pals-1.png" src="../_images/palette-pals-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.11 </span><span class="caption-text">Qualitative colour palettes in <strong class="command">palette.pals</strong>; <em>R4</em> is the default one, as seen in <a class="reference internal" href="#fig-palette"><span class="std std-numref">Figure 13.10</span></a>.</span><a class="headerlink" href="#id36" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div></section>
<section id="plot-margins-and-clipping-regions">
<span id="sec-plot-margins"></span><h3><span class="section-number">13.2.2. </span>Plot margins and clipping regions<a class="headerlink" href="#plot-margins-and-clipping-regions" title="Permalink to this heading">#</a></h3>
<p>A <em>device (page) region</em> represents a single plot window,
one raster image file, or a page in a PDF document
(see <a class="reference internal" href="#sec-grdevices"><span class="std std-numref">Section 13.2.6</span></a> for more information on graphics devices).
As we will learn from <a class="reference internal" href="#sec-mfrow"><span class="std std-numref">Section 13.2.5</span></a>, it is capable of holding
many <em>figures</em>.</p>
<p>Usually, however, we draw <em>one figure per page</em>. In such a case,
the device region is divided into the following parts:</p>
<ol class="arabic">
<li><p><em>outer margins</em>, which can be set via, e.g., the <code class="docutils literal notranslate"><span class="pre">oma</span></code> graphics
parameter (in text lines, based on the height of the default font);
by default, they are equal to 0;</p></li>
<li><p><em>figure region</em>:</p>
<p>a) <em>inner (plot) margins</em>, by default
<code class="docutils literal notranslate"><span class="pre">mar=</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(5.1,</span> <span class="pre">4.1,</span> <span class="pre">4.1,</span> <span class="pre">2.1)</span></code> text lines
(bottom, left, top, right, respectively);
this is where we usually emplace the figure title, axes labels, etc.</p>
<p>b) <em>plot region</em>, where we draw graphics primitives positioned relative
to the user coordinates.</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Typically, all drawings are <em>clipped</em> to the plot region,
but this can be changed with the <code class="docutils literal notranslate"><span class="pre">xpd</span></code> parameter;
see also the more flexible <strong class="command">clip</strong> function.</p>
</div>
<div class="proof proof-type-example" id="id37">

    <div class="proof-title">
        <span class="proof-type">Example 13.12</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-margins1"><span class="std std-numref">Figure 13.12</span></a> shows the default page layout.
In the code chunk below, note the use of <strong class="command">mtext</strong>
to print a text line in the inner margins,
<strong class="command">box</strong> to draw a rectangle around the plot or figure
region, <strong class="command">axis</strong> to add the two axes (labels and tick marks),
and <strong class="command">title</strong> to add some descriptive labels.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w">  </span><span class="c1"># whatever</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1"># some text lines on the inner margins</span>
<span class="w">    </span><span class="nf">for </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">seq_len</span><span class="p">(</span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;mar&quot;</span><span class="p">)[</span><span class="n">i</span><span class="p">]))</span>
<span class="w">        </span><span class="nf">mtext</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Text line %d on inner margin %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span>
<span class="w">            </span><span class="n">side</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="n">j</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;lightgray&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">title</span><span class="p">(</span><span class="n">main</span><span class="o">=</span><span class="s">&quot;Main&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="o">=</span><span class="s">&quot;sub&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;xlab&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;ylab&quot;</span><span class="p">)</span>
<span class="nf">box</span><span class="p">(</span><span class="s">&quot;figure&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># a box around the figure region</span>
<span class="nf">box</span><span class="p">(</span><span class="s">&quot;plot&quot;</span><span class="p">)</span><span class="w">   </span><span class="c1"># a box around the plot region</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># horizontal axis (bottom)</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># vertical axis (left)</span>

<span class="nf">rect</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;lightgray&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># rectangle (clipped to plot region)</span>
<span class="nf">text</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Plot region&quot;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-3</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">-2</span><span class="p">))</span><span class="w">  </span><span class="c1"># standard clipping (plot region)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-3</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="m">1.25</span><span class="p">,</span><span class="w"> </span><span class="m">-2</span><span class="p">),</span><span class="w"> </span><span class="n">xpd</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w">  </span><span class="c1"># clip to figure region</span>
</pre></div>
</div>
<figure class="align-default" id="id38">
<span id="fig-margins1"></span><img alt="../_images/margins1-1.png" src="../_images/margins1-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.12 </span><span class="caption-text">Figure layout with default inner and outer margins (<code class="docutils literal notranslate"><span class="pre">mar=</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(5.1,</span> <span class="pre">4.1,</span> <span class="pre">4.1,</span> <span class="pre">2.1)</span></code> and <code class="docutils literal notranslate"><span class="pre">oma=</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0)</span></code> text lines, respectively). We see that a lot of space is wasted and hence some tweaking might be necessary to suit our needs better. Note the clipping of the solid line to the grey plot region.</span><a class="headerlink" href="#id38" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div></section>
<section id="user-coordinates-and-axes">
<span id="sec-plot-usr-axis"></span><h3><span class="section-number">13.2.3. </span>User coordinates and axes<a class="headerlink" href="#user-coordinates-and-axes" title="Permalink to this heading">#</a></h3>
<p><strong class="command">plot.window</strong> sets the user coordinates.
It accepts the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xlim</span></code>, <code class="docutils literal notranslate"><span class="pre">ylim</span></code> – vectors of length two giving the minimal and maximal
ranges on the respective axes;
by default, they are extended by 4% in each direction
for aesthetic reasons (see, e.g., <a class="reference internal" href="#fig-margins1"><span class="std std-numref">Figure 13.12</span></a>)
but we can disable this behaviour by setting the <code class="docutils literal notranslate"><span class="pre">xaxs</span></code> and <code class="docutils literal notranslate"><span class="pre">yaxs</span></code>
graphics parameters;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">asp</span></code> – aspect ratio <span class="math">\((y/x)\)</span>; defaults to <code class="docutils literal notranslate"><span class="pre">NA</span></code>, i.e.,
no adjustment;
use <code class="docutils literal notranslate"><span class="pre">asp=1</span></code> for circles to look like ones, and not ovals;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log</span></code> – logarithmic scaling on particular axes:
<code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> (none; default), <code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;xy&quot;</span></code>.</p></li>
</ul>
<div class="proof proof-type-example" id="id39">

    <div class="proof-title">
        <span class="proof-type">Example 13.13</span>
        
    </div><div class="proof-content">
<p>The graphics parameter <code class="docutils literal notranslate"><span class="pre">usr</span></code> can be used to read (and set)
the extremes of the user coordinates in the form
<span class="math">\((x_1, x_2, y_1, y_2)\)</span>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot.new</span><span class="p">()</span>
<span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">),</span><span class="w"> </span><span class="n">log</span><span class="o">=</span><span class="s">&quot;y&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yaxs</span><span class="o">=</span><span class="s">&quot;i&quot;</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="s">&quot;usr&quot;</span><span class="p">)</span>
<span class="c1">## [1] -1.08  1.08  0.00  3.00</span>
</pre></div>
</div>
<p>Indeed, the x-axis range was extended by 4% in each direction
(<code class="docutils literal notranslate"><span class="pre">xaxs=&quot;r&quot;</span></code>). We have turned this behaviour off for the y-axis (<code class="docutils literal notranslate"><span class="pre">yaxs=&quot;i&quot;</span></code>),
which uses the base-10 logarithmic scale. In this case, its actual range is
<code class="docutils literal notranslate"><span class="pre">10^</span></code><strong class="command">par</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;usr&quot;)[3:4]</span></code>
because <span class="math">\(\log_{10} 1=0\)</span> and <span class="math">\(\log_{10} 1000=3\)</span>.</p>
</div></div><div class="proof proof-type-exercise" id="id40">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.14</span>
        
    </div><div class="proof-content">
<p>Implement your version of the <strong class="command">abline</strong> function
using <strong class="command">lines</strong>.</p>
</div></div><div style="margin-top: 1em"></div><p>Even though axes (labels and tick marks) can be drawn
manually using the aforementioned graphics primitives,
it is usually too tedious a work.</p>
<p>This is why we tend to rely on the <strong class="command">axis</strong> function,
which draws the object on one of the plot sides (as usual,
1=bottom, …, 4=right).</p>
<p>Once <strong class="command">plot.window</strong> is called, <strong class="command">axTicks</strong>
can be called to guesstimate some tasteful (<em>round</em>) locations for the tick
marks relative to the current plot size.
By default, they are based on the <code class="docutils literal notranslate"><span class="pre">xaxp</span></code> and <code class="docutils literal notranslate"><span class="pre">yaxp</span></code> graphics parameters,
which give the axis ranges and the number of intervals between
the tick marks.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-0.9</span><span class="p">,</span><span class="w"> </span><span class="m">1.05</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">11</span><span class="p">))</span>
<span class="nf">par</span><span class="p">(</span><span class="s">&quot;usr&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># (x1, x2, y1, y2)</span>
<span class="c1">## [1] -0.978  1.128  0.600 11.400</span>
<span class="nf">par</span><span class="p">(</span><span class="s">&quot;yaxp&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># (y1, y2, n)</span>
<span class="c1">## [1]  2 10  4</span>
<span class="nf">axTicks</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># left y-axis</span>
<span class="c1">## [1]  2  4  6  8 10</span>
<span class="nf">par</span><span class="p">(</span><span class="s">&quot;xaxp&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># (x1, x2, n)</span>
<span class="c1">## [1] -0.5  1.0  3.0</span>
<span class="nf">axTicks</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># bottom x-axis</span>
<span class="c1">## [1] -0.5  0.0  0.5  1.0</span>
<span class="nf">par</span><span class="p">(</span><span class="n">xaxp</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-0.9</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">))</span><span class="w">  </span><span class="c1"># change</span>
<span class="nf">axTicks</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="c1">## [1] -0.90 -0.52 -0.14  0.24  0.62  1.00</span>
</pre></div>
</div>
<p><strong class="command">axis</strong> relies on the same algorithm as <strong class="command">axTicks</strong>.
Alternatively, we can provide custom tick locations and labels.</p>
<div class="proof proof-type-example" id="id41">

    <div class="proof-title">
        <span class="proof-type">Example 13.15</span>
        
    </div><div class="proof-content">
<p>Most of the plots in this book use the following graphics settings
(except <code class="docutils literal notranslate"><span class="pre">las=1</span></code> to <strong class="command">axis</strong><code class="code docutils literal notranslate"><span class="pre">(2)</span></code>); see
<a class="reference internal" href="#fig-mysettsgraph"><span class="std std-numref">Figure 13.13</span></a>. Check out
<strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;par&quot;)</span></code>, <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;axis&quot;)</span></code>, etc. and tune them up to suit your needs.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">))</span>
<span class="nf">par</span><span class="p">(</span><span class="n">tcl</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span><span class="w">  </span><span class="c1"># the length of the tick marks (fraction of text line height)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mgp</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1.1</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w">  </span><span class="c1"># axis title, axis labels, and axis line location</span>
<span class="nf">par</span><span class="p">(</span><span class="n">cex.main</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">font.main</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># bold, normal size - main in title</span>
<span class="nf">par</span><span class="p">(</span><span class="n">cex.axis</span><span class="o">=</span><span class="m">0.8889</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">cex.lab</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">font.lab</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w">  </span><span class="c1"># bold italic, normal size</span>
<span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="c1"># a &quot;grid&quot;:</span>
<span class="nf">rect</span><span class="p">(</span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;usr&quot;</span><span class="p">)[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;usr&quot;</span><span class="p">)[</span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;usr&quot;</span><span class="p">)[</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;usr&quot;</span><span class="p">)[</span><span class="m">4</span><span class="p">],</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;#00000010&quot;</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="nf">axTicks</span><span class="p">(</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="c1"># set up axes:</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1/3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2/3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">las</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="nf">title</span><span class="p">(</span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;xlab&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;ylab&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s">&quot;main (use sparingly)&quot;</span><span class="p">)</span>
<span class="nf">box</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id42">
<span id="fig-mysettsgraph"></span><img alt="../_images/mysettsgraph-1.png" src="../_images/mysettsgraph-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.13 </span><span class="caption-text">Custom axes and other settings.</span><a class="headerlink" href="#id42" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div></section>
<section id="plot-dimensions">
<span id="sec-plot-inch"></span><h3><span class="section-number">13.2.4. </span>Plot dimensions (*)<a class="headerlink" href="#plot-dimensions" title="Permalink to this heading">#</a></h3>
<p>Certain sizes can be read or specified in inches
(1” is exactly 25.4 mm):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pin</span></code> – plot dimensions (width, height),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fin</span></code> – figure region dimensions,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">din</span></code> – page (device) dimensions,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mai</span></code> – plot (inner) margin size,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">omi</span></code> – outer margins,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cin</span></code> – the size of the “default” character (width, height).</p></li>
</ul>
<p>If the figure is scaled, the <em>virtual</em> inch
(the one reported by R) will not match the physical one
(e.g., the actual size in the printed version of this book
or on the computer screen).</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Most objects’ positions are specified
in <em>virtual</em> user coordinates, as given by <code class="docutils literal notranslate"><span class="pre">usr</span></code>.
They are automatically mapped to the <em>physical</em> device region,
taking into account the page size, outer and inner margins, etc.</p>
</div>
<p>Knowing the above, some basic scaling can be used
to convert between the user and physical sizes (in inches).
It is based on the ratios
<code class="docutils literal notranslate"><span class="pre">(usr[2]-usr[1])/pin[1]</span></code> and <code class="docutils literal notranslate"><span class="pre">(usr[4]-usr[3])/pin[2]</span></code>;
compare the <strong class="command">xinch</strong> and <strong class="command">yinch</strong> functions.</p>
<div class="proof proof-type-example" id="id43">

    <div class="proof-title">
        <span class="proof-type">Example 13.16</span>
        
    </div><div class="proof-content">
<p>(*) <a class="reference internal" href="#fig-user-coords"><span class="std std-numref">Figure 13.14</span></a> shows how we can pinpoint
the edges of the figure and device region in user coordinates.</p>
</div></div><figure class="align-default" id="id44">
<span id="fig-user-coords"></span><img alt="../_images/user-coords-1.png" src="../_images/user-coords-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.14 </span><span class="caption-text">User vs device coordinates. Note that the virtual inch does not correspond to the physical one, as some scaling was applied.</span><a class="headerlink" href="#id44" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="proof proof-type-exercise" id="id45">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.17</span>
        
    </div><div class="proof-content">
<p>(*) We cannot use <strong class="command">mtext</strong> to print
text on the right inner margin rotated by 180 degrees
compared to what we see in <a class="reference internal" href="#fig-margins1"><span class="std std-numref">Figure 13.12</span></a>.
Write your version of this function that will allow you to
do so.
Hint: use <strong class="command">text</strong>, the <code class="docutils literal notranslate"><span class="pre">cin</span></code> graphics parameter,
and what you can read from <a class="reference internal" href="#fig-user-coords"><span class="std std-numref">Figure 13.14</span></a>.</p>
</div></div></section>
<section id="many-figures-on-one-page-subplots">
<span id="sec-mfrow"></span><h3><span class="section-number">13.2.5. </span>Many figures on one page (subplots)<a class="headerlink" href="#many-figures-on-one-page-subplots" title="Permalink to this heading">#</a></h3>
<p>It is possible to create many figures on one page.
In such a case, each subplot has its own inner margins and plot region.</p>
<p>A call to <strong class="command">par</strong><code class="code docutils literal notranslate"><span class="pre">(mfrow=</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(nr,</span> <span class="pre">nc))</span></code>
or <strong class="command">par</strong><code class="code docutils literal notranslate"><span class="pre">(mfcol=</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(nr,</span> <span class="pre">nc))</span></code>
splits the page into a regular grid with <code class="docutils literal notranslate"><span class="pre">nr</span></code> rows and <code class="docutils literal notranslate"><span class="pre">nc</span></code> columns.
Each invocation of <strong class="command">plot.new</strong> starts a new figure.
Consecutive figures are either placed in a rowwise manner (<code class="docutils literal notranslate"><span class="pre">mfrow</span></code>)
or the columnwise one (<code class="docutils literal notranslate"><span class="pre">mfcol</span></code>). Alternatively,
the <code class="docutils literal notranslate"><span class="pre">mfg</span></code> parameter can enforce a custom order.</p>
<div class="proof proof-type-example" id="id46">

    <div class="proof-title">
        <span class="proof-type">Example 13.18</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-margins2"><span class="std std-numref">Figure 13.15</span></a> depicts an example page with four figures
aligned on a <span class="math">\(2\times 2\)</span> grid.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">oma</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span><span class="w">  </span><span class="c1"># outer margins (default 0)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">  </span><span class="c1"># a 2x2 plot grid</span>

<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">plot.new</span><span class="p">()</span>
<span class="w">    </span><span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">  </span><span class="c1"># each subplot will have the same inner margins</span>
<span class="w">    </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">i</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="m">+1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w">  </span><span class="c1"># separate user coordinates for each</span>

<span class="w">    </span><span class="nf">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Plot region (plot %d)\n(%d, %d)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span>
<span class="w">        </span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;mfg&quot;</span><span class="p">)[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;mfg&quot;</span><span class="p">)[</span><span class="m">2</span><span class="p">]))</span>

<span class="w">    </span><span class="nf">box</span><span class="p">(</span><span class="s">&quot;figure&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># a box around the figure region</span>
<span class="w">    </span><span class="nf">box</span><span class="p">(</span><span class="s">&quot;plot&quot;</span><span class="p">)</span><span class="w">   </span><span class="c1"># a box around the plot region</span>
<span class="w">    </span><span class="nf">axis</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># horizontal axis (bottom)</span>
<span class="w">    </span><span class="nf">axis</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># vertical axis (left)</span>
<span class="p">}</span>

<span class="nf">box</span><span class="p">(</span><span class="s">&quot;outer&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="s">&quot;dotdash&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># a box around the whole page</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span>
<span class="w">    </span><span class="nf">mtext</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Outer margin %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">side</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">outer</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id47">
<span id="fig-margins2"></span><img alt="../_images/margins2-1.png" src="../_images/margins2-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.15 </span><span class="caption-text">A page with four figures created using <strong class="command">par</strong><code class="code docutils literal notranslate"><span class="pre">(mfrow=</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2))</span></code>.</span><a class="headerlink" href="#id47" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><p>Thanks to <code class="docutils literal notranslate"><span class="pre">mfrow</span></code> and <code class="docutils literal notranslate"><span class="pre">mfcol</span></code>, we can create a scatter plot matrix
or different trellis plots.
If an irregular grid is required, we can call the slightly more
sophisticated <strong class="command">layout</strong> function
(which is incompatible with <code class="docutils literal notranslate"><span class="pre">mfrow</span></code> and <code class="docutils literal notranslate"><span class="pre">mfcol</span></code>).
Examples will follow later; see
<a class="reference internal" href="#fig-layout-demo"><span class="std std-numref">Figure 13.24</span></a> and <a class="reference internal" href="#fig-trellis-demo"><span class="std std-numref">Figure 13.26</span></a>.</p>
<p>Certain grid sizes might affect the <code class="docutils literal notranslate"><span class="pre">mex</span></code> and <code class="docutils literal notranslate"><span class="pre">cex</span></code> parameters
and hence the default font sizes (amongst others).
Refer to the documentation of <strong class="command">par</strong> for more details.</p>
</section>
<section id="graphics-devices">
<span id="sec-grdevices"></span><h3><span class="section-number">13.2.6. </span>Graphics devices<a class="headerlink" href="#graphics-devices" title="Permalink to this heading">#</a></h3>
<p>Where our plots are <em>displayed</em> depends on our development environment
(<a class="reference internal" href="110-basics.html#sec-ide"><span class="std std-numref">Section 1.2</span></a>). Users of <strong class="program">JupyterLab</strong> see the plots embedded
into the current notebook, consumers of <strong class="program">RStudio</strong> display them
in a dedicated <em>Plots</em> pane, working from the console opens a new graphics
window (unless we work in a text-only environment), whereas compiling
<strong class="program">utils</strong><code class="code docutils literal notranslate"><span class="pre">::</span></code><strong class="command">Sweave</strong> or <strong class="program">knitr</strong>
markup files brings about an image file that will be included
in the output document.</p>
<p>In practice, we might be interested in exercising our
creative endeavours on different devices.
For instance, to draw something in a PDF file, we can call:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">cairo_pdf</span><span class="p">(</span><span class="s">&quot;figure.pdf&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="o">=</span><span class="m">3.5</span><span class="p">)</span><span class="w">  </span><span class="c1"># open &quot;device&quot;</span>
<span class="c1"># ... calls to plotting functions...</span>
<span class="nf">dev.off</span><span class="p">()</span><span class="w">  </span><span class="c1"># save file, close device</span>
</pre></div>
</div>
<p>Similarly, a call to <strong class="command">png</strong> or <strong class="command">svg</strong>
creates a PNG or a SVG file.
In both cases, as we rely on the <strong class="program">Cairo</strong> library,
we can customise the font family by calling
<strong class="program">Cairo</strong><code class="code docutils literal notranslate"><span class="pre">::</span></code><strong class="command">CairoFonts</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Typically, web browsers can display JPEG, PNG, and SVG files.
PDF is a popular choice in printed publications
(e.g., articles or books).</p>
<p>It is worth knowing that PNG and JPEG are raster graphics formats,
i.e., they store figures as bitmaps (pixel matrices).
They are fast to render, but the file sizes might become immense
if we want decent image quality (high resolution). Most importantly,
they should not be scaled: it is best to display them
at their original widths and heights.
However, JPEG uses lossy compression. Therefore, it is not
a particularly fortunate file format for data visualisations.
It does not support transparency either.</p>
<p>On the other hand, SVG and PDF files store vector graphics,
where all primitives are described geometrically. This way,
the image can be redrawn at any size and is always expected to be aesthetic.
Unfortunately, scatter plots with millions of points
will result in considerable files size and relatively slow rendition times
(but there are tricks to remedy this).</p>
</div>
<p>Users of TeX might be interested in
<strong class="program">tikzDevice</strong><code class="code docutils literal notranslate"><span class="pre">::</span></code><strong class="command">tikz</strong>, which creates
TikZ files that can be rendered as standalone PDF files
or embedded in LaTeX documents (and its variants).
It allows for typesetting beautiful equations using the standard
<code class="docutils literal notranslate"><span class="pre">&quot;$...$&quot;</span></code> syntax within any R string.</p>
<p>Many other devices are listed in <strong class="command">help</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;Devices&quot;)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(*) The opened graphics devices form a stack.
Calling <strong class="command">dev.off</strong> will return to the last opened device (if any).
See <strong class="command">dev.list</strong> and other functions listed in its help page
for more information.</p>
<p>Each device has separate graphics parameters. When opening a new
device, we start with default settings in place.</p>
<p>Also, <strong class="command">dev.hold</strong> and <strong class="command">dev.flush</strong>
can suppress the immediate display of the plotted objects,
which might increase the drawing speed on certain interactive devices.</p>
<p>The current plot can be copied to another device (e.g.,
a PDF file) using <strong class="command">dev.print</strong>.</p>
</div>
<div class="proof proof-type-exercise" id="id48">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.19</span>
        
    </div><div class="proof-content">
<p>(*) Create an animated PNG displaying a large point sliding along the
sine curve. Generate a series of video frames like in
<a class="reference internal" href="#fig-animation"><span class="std std-numref">Figure 13.16</span></a>. Store each frame in a separate PNG file.
Then, use <a class="reference external" href="https://imagemagick.org/"><strong class="program">ImageMagick</strong></a>
(compare <a class="reference internal" href="170-function.html#sec-external-programs"><span class="std std-numref">Section 7.3.2</span></a>; or rely on some other tool)
to combine these files as a single animated PNG.</p>
<figure class="align-default" id="id49">
<span id="fig-animation"></span><img alt="../_images/animation-1.png" src="../_images/animation-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.16 </span><span class="caption-text">Selected frames of an example animation. They can be stored in separate files and then combined as a single animated PNG.</span><a class="headerlink" href="#id49" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div></section>
</section>
<section id="higher-level-functions">
<span id="sec-high-level-plotting"></span><h2><span class="section-number">13.3. </span>Higher-level functions<a class="headerlink" href="#higher-level-functions" title="Permalink to this heading">#</a></h2>
<p>Higher-level plotting commands call <strong class="command">plot.new</strong>,
<strong class="command">plot.window</strong>, <strong class="command">axis</strong>, <strong class="command">box</strong>,
<strong class="command">title</strong>, etc., and draw graphics primitives on our behalf.
They provide ready-to-use implementations of the most common data
visualisation tools, e.g., box-and-whisker plots, histograms,
pairs plots, etc.</p>
<p>Below we review some of them. We also show how they can be customised
or even rewritten from scratch if we are not completely happy with them.
They will inspire us to practice some lower-level
graphics programming.</p>
<div class="proof proof-type-exercise" id="id50">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.20</span>
        
    </div><div class="proof-content">
<p>Check out the meaning of the <code class="docutils literal notranslate"><span class="pre">ask</span></code>, <code class="docutils literal notranslate"><span class="pre">new</span></code>, <code class="docutils literal notranslate"><span class="pre">xaxt</span></code>, <code class="docutils literal notranslate"><span class="pre">yaxt</span></code>, and <code class="docutils literal notranslate"><span class="pre">ann</span></code>
graphics parameters
and how they affect <strong class="command">plot.new</strong>, <strong class="command">axis</strong>,
<strong class="command">title</strong>, and so forth.</p>
</div></div><section id="scatter-and-function-plots-with-plot-default-and-matplot">
<h3><span class="section-number">13.3.1. </span>Scatter and function plots with <strong class="command">plot.default</strong> and <strong class="command">matplot</strong><a class="headerlink" href="#scatter-and-function-plots-with-plot-default-and-matplot" title="Permalink to this heading">#</a></h3>
<p>The default method for the S3 generic <strong class="command">plot</strong>
is a convenient wrapper around <strong class="command">points</strong> and <strong class="command">lines</strong>.</p>
<div class="proof proof-type-example" id="id51">

    <div class="proof-title">
        <span class="proof-type">Example 13.21</span>
        
    </div><div class="proof-content">
<p><strong class="command">plot.default</strong> can draw a scatter plot of a set of points
in <span class="math">\(\mathbb{R}^2\)</span> possibly grouped by another categorical variable.
From <a class="reference internal" href="220-s3.html#sec-factor"><span class="std std-numref">Section 10.3.2</span></a> we know that a factor is represented as a vector
of small natural numbers. Therefore, its underlying level codes
can be used directly as <code class="docutils literal notranslate"><span class="pre">col</span></code> or <code class="docutils literal notranslate"><span class="pre">pch</span></code> specifiers;
see <a class="reference internal" href="#fig-irisplot-factors"><span class="std std-numref">Figure 13.17</span></a> for a demonstration.
Take note of a call to the <strong class="command">legend</strong> function.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span>
<span class="w">    </span><span class="nf">jitter</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Sepal.Length&quot;</span><span class="p">]]),</span><span class="w">  </span><span class="c1"># x (it is a numeric vector)</span>
<span class="w">    </span><span class="nf">jitter</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Petal.Width&quot;</span><span class="p">]]),</span><span class="w">   </span><span class="c1"># y (it is a numeric vector)</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]]),</span><span class="w">  </span><span class="c1"># colours (integer codes)</span>
<span class="w">    </span><span class="n">pch</span><span class="o">=</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]]),</span><span class="w">  </span><span class="c1"># plotting symbols (integer codes)</span>
<span class="w">    </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Sepal length&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Petal width&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">asp</span><span class="o">=</span><span class="m">1</span><span class="w">  </span><span class="c1"># y/x aspect ratio</span>
<span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;bottomright&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">legend</span><span class="o">=</span><span class="nf">levels</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]]),</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="nf">seq_along</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]])),</span>
<span class="w">    </span><span class="n">pch</span><span class="o">=</span><span class="nf">seq_along</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]])),</span>
<span class="w">    </span><span class="n">bg</span><span class="o">=</span><span class="s">&quot;white&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id52">
<span id="fig-irisplot-factors"></span><img alt="../_images/irisplot-factors-1.png" src="../_images/irisplot-factors-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.17 </span><span class="caption-text"><strong class="command">as.numeric</strong> can define different plotting styles for each factor level.</span><a class="headerlink" href="#id52" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-exercise" id="id53">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.22</span>
        
    </div><div class="proof-content">
<p>Pass <code class="docutils literal notranslate"><span class="pre">ann=FALSE</span></code> and <code class="docutils literal notranslate"><span class="pre">axes=FALSE</span></code> to <strong class="command">plot</strong> to
suppress the addition of axes and labels. Then, draw them manually
using the functions discussed in the previous section.</p>
</div></div><div class="proof proof-type-exercise" id="id54">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.23</span>
        
    </div><div class="proof-content">
<p>Draw a plot of the <span class="math">\(y=\sin x\)</span> function using <strong class="command">plot</strong>.
Then, call <strong class="command">lines</strong> to add <span class="math">\(y=\cos x\)</span>.
Later, do the same using a single reference to <strong class="command">matplot</strong>.
Include a legend.</p>
</div></div><div class="proof proof-type-example" id="id55">

    <div class="proof-title">
        <span class="proof-type">Example 13.24</span>
        
    </div><div class="proof-content">
<p>Semi-transparency may convey additional information.
<a class="reference internal" href="#fig-semitrans-scatter"><span class="std std-numref">Figure 13.18</span></a> shows two scatter plots of
adult females’ weights vs heights. If the points are fully opaque,
we cannot judge the density around them.
On the other hand, translucent symbols somewhat imitate
the two-dimensional histograms that we will later depict in
<a class="reference internal" href="#fig-colour-density2d"><span class="std std-numref">Figure 13.29</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="w">  </span><span class="c1"># see https://github.com/gagolews/teaching-data</span>
<span class="w">    </span><span class="n">file</span><span class="o">=</span><span class="s">&quot;~/Projects/teaching-data/marek/nhanes_adult_female_bmx_2020.csv&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">comment.char</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col.names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;weight&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;height&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;armlen&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;leglen&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;armcirc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hipcirc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;waistcirc&quot;</span><span class="p">))</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>
<span class="nf">for </span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#00000010&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">nhanes</span><span class="p">[[</span><span class="s">&quot;height&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">nhanes</span><span class="p">[[</span><span class="s">&quot;weight&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
<span class="w">        </span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Height&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Weight&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id56">
<span id="fig-semitrans-scatter"></span><img alt="../_images/semitrans-scatter-1.png" src="../_images/semitrans-scatter-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.18 </span><span class="caption-text">Semi-transparent symbols can reflect the points’ distribution density.</span><a class="headerlink" href="#id56" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-example" id="id57">

    <div class="proof-title">
        <span class="proof-type">Example 13.25</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-semitrans-ribbon"><span class="std std-numref">Figure 13.19</span></a> depicts the average monthly temperatures
in your next holiday destination: Warsaw, Poland (a time series).
Note that the translucent ribbon representing the low-high average
temperature intervals was added using a call to <strong class="command">polygon</strong>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Warsaw monthly temperatures; source: https://en.wikipedia.org/wiki/Warsaw</span>
<span class="n">high</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w">  </span><span class="m">1.9</span><span class="p">,</span><span class="w">  </span><span class="m">6.6</span><span class="p">,</span><span class="w"> </span><span class="m">13.6</span><span class="p">,</span><span class="w"> </span><span class="m">19.5</span><span class="p">,</span><span class="w"> </span><span class="m">21.9</span><span class="p">,</span>
<span class="w">          </span><span class="m">24.4</span><span class="p">,</span><span class="w"> </span><span class="m">23.9</span><span class="p">,</span><span class="w"> </span><span class="m">18.4</span><span class="p">,</span><span class="w"> </span><span class="m">12.7</span><span class="p">,</span><span class="w">  </span><span class="m">5.9</span><span class="p">,</span><span class="w">  </span><span class="m">1.6</span><span class="p">)</span>
<span class="n">mean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1.8</span><span class="p">,</span><span class="w"> </span><span class="m">-0.6</span><span class="p">,</span><span class="w">  </span><span class="m">2.8</span><span class="p">,</span><span class="w">  </span><span class="m">8.7</span><span class="p">,</span><span class="w"> </span><span class="m">14.2</span><span class="p">,</span><span class="w"> </span><span class="m">17.0</span><span class="p">,</span>
<span class="w">          </span><span class="m">19.2</span><span class="p">,</span><span class="w"> </span><span class="m">18.3</span><span class="p">,</span><span class="w"> </span><span class="m">13.5</span><span class="p">,</span><span class="w">  </span><span class="m">8.5</span><span class="p">,</span><span class="w">  </span><span class="m">3.3</span><span class="p">,</span><span class="w"> </span><span class="m">-0.7</span><span class="p">)</span>
<span class="n">low</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-4.2</span><span class="p">,</span><span class="w"> </span><span class="m">-3.6</span><span class="p">,</span><span class="w"> </span><span class="m">-0.6</span><span class="p">,</span><span class="w">  </span><span class="m">3.9</span><span class="p">,</span><span class="w">  </span><span class="m">8.9</span><span class="p">,</span><span class="w"> </span><span class="m">11.8</span><span class="p">,</span>
<span class="w">          </span><span class="m">13.9</span><span class="p">,</span><span class="w"> </span><span class="m">13.1</span><span class="p">,</span><span class="w">  </span><span class="m">9.1</span><span class="p">,</span><span class="w">  </span><span class="m">4.8</span><span class="p">,</span><span class="w">  </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="m">-3.0</span><span class="p">)</span>
<span class="nf">matplot</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">high</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;o&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">1</span><span class="p">,</span>
<span class="w">    </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;month&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;temperature [°C]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xaxt</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="n">month.abb</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="m">-0.25</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">lwd.ticks</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">polygon</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="nf">rev</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">)),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">high</span><span class="p">,</span><span class="w"> </span><span class="nf">rev</span><span class="p">(</span><span class="n">low</span><span class="p">)),</span><span class="w"> </span><span class="n">border</span><span class="o">=</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;#ffff0033&quot;</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;bottom&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;average high&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mean&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;average low&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">lty</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">bg</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id58">
<span id="fig-semitrans-ribbon"></span><img alt="../_images/semitrans-ribbon-1.png" src="../_images/semitrans-ribbon-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.19 </span><span class="caption-text">Example time series. A semi-transparent ribbon was added by calling <strong class="command">polygon</strong> to highlight the area between the low-high ranges (intervals).</span><a class="headerlink" href="#id58" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-example" id="id59">

    <div class="proof-title">
        <span class="proof-type">Example 13.26</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-colour-scatter"><span class="std std-numref">Figure 13.20</span></a> depicts a scatter plot
similar to <a class="reference internal" href="#fig-semitrans-scatter"><span class="std std-numref">Figure 13.18</span></a>, but now with the points’
hue being a function of a third variable.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">midpoints</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="m">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="m">-1</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>
<span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nhanes</span><span class="p">[[</span><span class="s">&quot;waistcirc&quot;</span><span class="p">]]</span>
<span class="n">breaks</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">z</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">z</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">10</span><span class="p">)</span>
<span class="n">zf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="p">,</span><span class="w"> </span><span class="n">include.lowest</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">col</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">hcl.colors</span><span class="p">(</span><span class="nf">nlevels</span><span class="p">(</span><span class="n">zf</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Viridis&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">),</span><span class="w">  </span><span class="c1"># two plots in one page</span>
<span class="w">    </span><span class="n">widths</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nf">lcm</span><span class="p">(</span><span class="m">3</span><span class="p">)))</span><span class="w">         </span><span class="c1"># second one is of width &quot;3cm&quot; (scaled)</span>
<span class="c1"># first subplot:</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">nhanes</span><span class="p">[[</span><span class="s">&quot;height&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">nhanes</span><span class="p">[[</span><span class="s">&quot;weight&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">[</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">zf</span><span class="p">)],</span>
<span class="w">    </span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Height&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Weight&quot;</span><span class="p">)</span>
<span class="c1"># second subplot:</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">))</span>
<span class="nf">plot.new</span><span class="p">();</span><span class="w"> </span><span class="nf">plot.window</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">nlevels</span><span class="p">(</span><span class="n">zf</span><span class="p">)))</span>
<span class="nf">rasterImage</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="nf">rev</span><span class="p">(</span><span class="n">col</span><span class="p">)),</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nf">nlevels</span><span class="p">(</span><span class="n">zf</span><span class="p">),</span><span class="w"> </span><span class="n">interpolate</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">nlevels</span><span class="p">(</span><span class="n">zf</span><span class="p">)</span><span class="m">-0.5</span><span class="p">,</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%3.0f&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">midpoints</span><span class="p">(</span><span class="n">breaks</span><span class="p">)))</span>
<span class="nf">mtext</span><span class="p">(</span><span class="s">&quot;Waist Ø&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">side</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id60">
<span id="fig-colour-scatter"></span><img alt="../_images/colour-scatter-1.png" src="../_images/colour-scatter-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.20 </span><span class="caption-text">A 2D scatter plot with a third variable represented by colours.</span><a class="headerlink" href="#id60" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-exercise" id="id61">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.27</span>
        
    </div><div class="proof-content">
<p>Implement your version of <strong class="command">pairs</strong>, being the function
to draw a scatter plot matrix (a pairs plot).</p>
</div></div><div class="proof proof-type-exercise" id="id62">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.28</span>
        
    </div><div class="proof-content">
<p><strong class="command">ecdf</strong> returns an object of the S3 classes
<strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(&quot;ecdf&quot;,</span> <span class="pre">&quot;stepfun&quot;)</span></code>.
There are <strong class="command">plot</strong> methods overloaded for these classes.
Inspect their source code. Then, inspired by this,
create a function to compute and display
the empirical cumulative distribution function corresponding
to a given numeric vector.</p>
</div></div><div class="proof proof-type-exercise" id="id63">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.29</span>
        
    </div><div class="proof-content">
<p><strong class="command">spline</strong> performs cubic spline interpolation,
whereas <strong class="command">smooth.spline</strong> determines a smoothing spline
of a given two-dimensional dataset.
Plot different splines for <code class="docutils literal notranslate"><span class="pre">cars[[&quot;dist&quot;]]</span></code> as a function
of <code class="docutils literal notranslate"><span class="pre">cars[[&quot;speed&quot;]]</span></code>. Which of these two functions is more appropriate
for depicting this dataset?</p>
</div></div></section>
<section id="bar-plots-and-histograms">
<h3><span class="section-number">13.3.2. </span>Bar plots and histograms<a class="headerlink" href="#bar-plots-and-histograms" title="Permalink to this heading">#</a></h3>
<p>A bar plot is drawn using a series of rectangles (i.e., some polygons)
of different heights (or widths, if we request horizontal alignment).</p>
<div class="proof proof-type-example" id="id64">

    <div class="proof-title">
        <span class="proof-type">Example 13.30</span>
        
    </div><div class="proof-content">
<p>Let us visualise the
<a class="reference external" href="https://www.cec.health.nsw.gov.au/CEC-Academy/quality-improvement-tools/pareto-charts">dataset</a> listing the most frequent causes of medication errors
(data are fabricated):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cat_med</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;Unauthorised drug&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Wrong IV rate&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Wrong patient&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Dose missed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Underdose&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Wrong calculation&quot;</span><span class="p">,</span><span class="s">&quot;Wrong route&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Wrong drug&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Wrong time&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Technique error&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Duplicated drugs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Overdose&quot;</span>
<span class="p">)</span>
<span class="n">counts_med</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">53</span><span class="p">,</span><span class="w"> </span><span class="m">92</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="m">27</span><span class="p">,</span><span class="w"> </span><span class="m">76</span><span class="p">,</span><span class="w"> </span><span class="m">83</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">59</span><span class="p">)</span>
</pre></div>
</div>
<p>A Pareto chart combines a bar plot featuring bars of decreasing heights
with a cumulative percentage curve; see <a class="reference internal" href="#fig-pareto-chart"><span class="std std-numref">Figure 13.21</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">o</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">order</span><span class="p">(</span><span class="n">counts_med</span><span class="p">)</span>
<span class="n">cato_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cat_med</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
<span class="n">pcto_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">counts_med</span><span class="p">[</span><span class="n">o</span><span class="p">]</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">counts_med</span><span class="p">)</span><span class="o">*</span><span class="m">100</span>
<span class="n">cumpcto_med</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rev</span><span class="p">(</span><span class="nf">cumsum</span><span class="p">(</span><span class="nf">rev</span><span class="p">(</span><span class="n">pcto_med</span><span class="p">)))</span>
<span class="c1"># bar plot of percentages</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">6.6</span><span class="p">))</span><span class="w">  </span><span class="c1"># wide left margin</span>
<span class="n">midp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">barplot</span><span class="p">(</span><span class="n">pcto_med</span><span class="p">,</span><span class="w"> </span><span class="n">horiz</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;%&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="p">),</span><span class="w"> </span><span class="n">xaxs</span><span class="o">=</span><span class="s">&quot;r&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yaxs</span><span class="o">=</span><span class="s">&quot;r&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yaxt</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">width</span><span class="o">=</span><span class="m">3</span><span class="o">/</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">space</span><span class="o">=</span><span class="m">1</span><span class="o">/</span><span class="m">3</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="n">pcto_med</span><span class="p">,</span><span class="w"> </span><span class="n">midp</span><span class="p">,</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%.1f%%&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pcto_med</span><span class="p">),</span><span class="w"> </span><span class="n">pos</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">0.89</span><span class="p">)</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="o">=</span><span class="n">midp</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="n">cato_med</span><span class="p">,</span><span class="w"> </span><span class="n">las</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">box</span><span class="p">()</span>
<span class="c1"># cumulative percentage curve in a new coordinate system</span>
<span class="nf">par</span><span class="p">(</span><span class="n">usr</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="w"> </span><span class="m">104</span><span class="p">,</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;usr&quot;</span><span class="p">)[</span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="nf">par</span><span class="p">(</span><span class="s">&quot;usr&quot;</span><span class="p">)[</span><span class="m">4</span><span class="p">]))</span><span class="w">  </span><span class="c1"># 0-100 with 4% addition</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">cumpcto_med</span><span class="p">,</span><span class="w"> </span><span class="n">midp</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;o&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">18</span><span class="p">)</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
<span class="nf">mtext</span><span class="p">(</span><span class="s">&quot;cumulative %&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">side</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="n">cumpcto_med</span><span class="p">,</span><span class="w"> </span><span class="n">midp</span><span class="p">,</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%.1f%%&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cumpcto_med</span><span class="p">),</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">0.89</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">,</span>
<span class="w">    </span><span class="n">pos</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)[(</span><span class="n">cumpcto_med</span><span class="o">&gt;</span><span class="m">80</span><span class="p">)</span><span class="m">+1</span><span class="p">],</span><span class="w"> </span><span class="n">offset</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id65">
<span id="fig-pareto-chart"></span><img alt="../_images/pareto-chart-1.png" src="../_images/pareto-chart-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.21 </span><span class="caption-text">An example Pareto chart (a fancy bar plot). Double axes have a general tendency to confuse the reader.</span><a class="headerlink" href="#id65" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Note that <strong class="command">barplot</strong> returned the midpoints of the bars,
which we put in good use.
By default, it sets the <code class="docutils literal notranslate"><span class="pre">xaxs=&quot;i&quot;</span></code> graphics parameter and thus
does not extend the x-axis range by 4% on both sides. This would not make
us happy here, therefore we needed to change it manually.</p>
</div></div><div class="proof proof-type-exercise" id="id66">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.31</span>
        
    </div><div class="proof-content">
<p>Draw a bar plot summarising, for each passenger class and sex,
the number of adults who did not survive the sinking of the deadliest
1912 cruise; see <a class="reference internal" href="#fig-bar-plot-titanic"><span class="std std-numref">Figure 13.22</span></a> and the
<code class="docutils literal notranslate"><span class="pre">Titanic</span></code> dataset.</p>
<figure class="align-default" id="id67">
<span id="fig-bar-plot-titanic"></span><img alt="../_images/bar-plot-titanic-1.png" src="../_images/bar-plot-titanic-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.22 </span><span class="caption-text">An example bar plot representing a two-way contingency table.</span><a class="headerlink" href="#id67" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-exercise" id="id68">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.32</span>
        
    </div><div class="proof-content">
<p>Implement your version of <strong class="command">barplot</strong>,
but where the bars are placed precisely at the positions
specified by the user, e.g., allowing the bar midpoints to be
consecutive integers.</p>
</div></div><p>We will definitely not cover the (in)famous pie charts in our
book. The human brain is not very skilled at judging the relative differences
between the areas of geometric objects. Also, they are ugly.</p>
<div style="margin-top: 1em"></div><p>Moving on: a histogram is a simple density estimator for continuous data.
It can be thought of as a bar plot with bars of heights
proportional to the number of observations falling into
the corresponding disjoint intervals.
Most often, there is no space between the bars to emphasise that
the intervals cover the whole data range.</p>
<p>A histogram can be computed and drawn using the high-level function
<strong class="command">hist</strong>; see <a class="reference internal" href="#fig-hist-demo"><span class="std std-numref">Figure 13.23</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>
<span class="nf">for </span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="s">&quot;Sturges&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># Sturges (a heuristic) is the default; any value is merely a suggestion</span>
<span class="w">    </span><span class="nf">hist</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Sepal.Length&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">probability</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Sepal length&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">main</span><span class="o">=</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">breaks</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">box</span><span class="p">()</span><span class="w">  </span><span class="c1"># weirdly, we need to add it manually</span>
<span class="p">}</span>
</pre></div>
</div>
<figure class="align-default" id="id69">
<span id="fig-hist-demo"></span><img alt="../_images/hist-demo-1.png" src="../_images/hist-demo-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.23 </span><span class="caption-text">Example histograms for the same dataset.</span><a class="headerlink" href="#id69" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="proof proof-type-exercise" id="id70">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.33</span>
        
    </div><div class="proof-content">
<p>Study the source code of <strong class="command">hist.default</strong>.
Note the invisibly-returned list of the S3 class <code class="docutils literal notranslate"><span class="pre">histogram</span></code>.
Then, study <strong class="program">graphics</strong><code class="code docutils literal notranslate"><span class="pre">:::</span></code><strong class="command">plot.histogram</strong>.
Implement similar functions yourself.</p>
</div></div><div class="proof proof-type-exercise" id="id71">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.34</span>
        
    </div><div class="proof-content">
<p>Modify your function to draw a scatter plot matrix
so that it gives the histograms of the marginal distributions
on its diagonal.</p>
</div></div><div class="proof proof-type-example" id="id72">

    <div class="proof-title">
        <span class="proof-type">Example 13.35</span>
        
    </div><div class="proof-content">
<p>Using <strong class="command">layout</strong> mentioned in <a class="reference internal" href="#sec-mfrow"><span class="std std-numref">Section 13.2.5</span></a>,
we can draw a scatter plot with marginal histograms;
see <a class="reference internal" href="#fig-layout-demo"><span class="std std-numref">Figure 13.24</span></a>.
Note that we split the page into four plots of unequal sizes,
but the upper right part of the grid is unused.
We use <strong class="command">hist</strong> for binning only (<code class="docutils literal notranslate"><span class="pre">plot=FALSE</span></code>). Then,
<strong class="command">barplot</strong> is utilised for drawing as it gives greater control
over the process (e.g., supports vertical layout).</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span>
<span class="w">    </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">  </span><span class="c1"># first row: first plot of width 3 and nothing</span>
<span class="w">      </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">  </span><span class="c1"># three rows: square third plot and a tall second</span>
<span class="w">      </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">      </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">nrow</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mex</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># the layout function changed this!</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">jitter</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Sepal.Length&quot;</span><span class="p">]])</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">jitter</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Sepal.Width&quot;</span><span class="p">]])</span>
<span class="c1"># first subplot (top)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">),</span><span class="w"> </span><span class="n">ann</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">hx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">20</span><span class="p">))</span>
<span class="nf">barplot</span><span class="p">(</span><span class="n">hx</span><span class="p">[[</span><span class="s">&quot;density&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">space</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">axes</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;#00000011&quot;</span><span class="p">)</span>
<span class="c1"># second subplot (right)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">),</span><span class="w"> </span><span class="n">ann</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">hy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">20</span><span class="p">))</span>
<span class="nf">barplot</span><span class="p">(</span><span class="n">hy</span><span class="p">[[</span><span class="s">&quot;density&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">space</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">axes</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">horiz</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;#00000011&quot;</span><span class="p">)</span>
<span class="c1"># third subplot (square)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">2.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">),</span><span class="w"> </span><span class="n">ann</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Sepal length&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Sepal width&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">xlim</span><span class="o">=</span><span class="nf">range</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">range</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="w">  </span><span class="c1"># default xlim, ylim</span>
</pre></div>
</div>
<figure class="align-default" id="id73">
<span id="fig-layout-demo"></span><img alt="../_images/layout-demo-1.png" src="../_images/layout-demo-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.24 </span><span class="caption-text">A scatter plot with marginal histograms: three (four) plots on one page, but on a nonuniform grid created using <strong class="command">layout</strong>.</span><a class="headerlink" href="#id73" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-example" id="id74">

    <div class="proof-title">
        <span class="proof-type">Example 13.36</span>
        
    </div><div class="proof-content">
<p>(*)
Kernel density estimators (KDEs) are another way to guesstimate
the data distribution. The <strong class="command">density</strong> function, for a given
numeric vector, returns a list with, amongst others,
the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> coordinates of the points that we can pass directly to
the <strong class="command">lines</strong> function.
Below we depict the KDEs of data split into three groups;
see <a class="reference internal" href="#fig-semitrans-density"><span class="std std-numref">Figure 13.25</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">adjust_transparency</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">)</span>
<span class="w">    </span><span class="nf">rgb</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="nf">col2rgb</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">/</span><span class="m">255</span><span class="p">),</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span><span class="w">  </span><span class="c1"># alpha in [0, 1]</span>

<span class="n">pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">adjust_transparency</span><span class="p">(</span><span class="nf">palette</span><span class="p">(),</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span>
<span class="n">kdes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="nf">split</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Sepal.Length&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]]),</span><span class="w"> </span><span class="n">density</span><span class="p">)</span>
<span class="nf">matplot</span><span class="p">(</span><span class="nf">sapply</span><span class="p">(</span><span class="n">kdes</span><span class="p">,</span><span class="w"> </span><span class="n">`[[`</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">sapply</span><span class="p">(</span><span class="n">kdes</span><span class="p">,</span><span class="w"> </span><span class="n">`[[`</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;y&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Sepal length&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;density&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">1.5</span><span class="p">)</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">kdes</span><span class="p">))</span>
<span class="w">    </span><span class="nf">polygon</span><span class="p">(</span><span class="n">kdes</span><span class="p">[[</span><span class="n">i</span><span class="p">]][[</span><span class="s">&quot;x&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">kdes</span><span class="p">[[</span><span class="n">i</span><span class="p">]][[</span><span class="s">&quot;y&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">border</span><span class="o">=</span><span class="kc">NA</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;topright&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="o">=</span><span class="nf">levels</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]]),</span><span class="w"> </span><span class="n">bg</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="nf">seq_along</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]])),</span>
<span class="w">    </span><span class="n">lty</span><span class="o">=</span><span class="nf">seq_along</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">iris</span><span class="p">[[</span><span class="s">&quot;Species&quot;</span><span class="p">]])))</span>
</pre></div>
</div>
<figure class="align-default" id="id75">
<span id="fig-semitrans-density"></span><img alt="../_images/semitrans-density-1.png" src="../_images/semitrans-density-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.25 </span><span class="caption-text">Kernel density estimators of sepal length split by species in the <code class="docutils literal notranslate"><span class="pre">iris</span></code> dataset. Note the semi-transparent polygons (again).</span><a class="headerlink" href="#id75" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-exercise" id="id76">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.37</span>
        
    </div><div class="proof-content">
<p>(*)
Implement a function that draws kernel density estimators for
a given numeric variable split by a combination of three factor levels;
see <a class="reference internal" href="#fig-trellis-demo"><span class="std std-numref">Figure 13.26</span></a> for an example.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">grid_kde</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">hue</span><span class="p">)</span><span class="w"> </span><span class="n">...to.do...</span>

<span class="n">tips</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;~/Projects/teaching-data/other/tips.csv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">comment.char</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># see https://github.com/gagolews/teaching-data</span>
<span class="nf">head</span><span class="p">(</span><span class="n">tips</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">  </span><span class="c1"># preview an example dataset</span>
<span class="c1">##   total_bill  tip    sex smoker day   time size</span>
<span class="c1">## 1      16.99 1.01 Female     No Sun Dinner    2</span>
<span class="c1">## 2      10.34 1.66   Male     No Sun Dinner    3</span>
<span class="c1">## 3      21.01 3.50   Male     No Sun Dinner    3</span>
<span class="nf">grid_kde</span><span class="p">(</span><span class="n">tips</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">=</span><span class="s">&quot;tip&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s">&quot;smoker&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hue</span><span class="o">=</span><span class="s">&quot;sex&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id77">
<span id="fig-trellis-demo"></span><img alt="../_images/trellis-demo-1.png" src="../_images/trellis-demo-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.26 </span><span class="caption-text">An example grid plot (also known as a trellis, panel, conditioning, or lattice plot) with kernel density estimators for a numeric variable (amount of tip in a US restaurant) split by a combination of three factor levels (smoker, time, sex).</span><a class="headerlink" href="#id77" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div></section>
<section id="box-and-whisker-plots">
<h3><span class="section-number">13.3.3. </span>Box-and-whisker plots<a class="headerlink" href="#box-and-whisker-plots" title="Permalink to this heading">#</a></h3>
<p>We have already seen a chart generated by the <strong class="command">boxplot</strong> function
in <a class="reference internal" href="150-indexing.html#fig-toothgrowth-boxplot"><span class="std std-numref">Figure 5.1</span></a>. Tinkering with it will
give us some robust practice, which in turn shall make us perfect.</p>
<div class="proof proof-type-exercise" id="id78">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.38</span>
        
    </div><div class="proof-content">
<p>Modify the code generating <a class="reference internal" href="150-indexing.html#fig-toothgrowth-boxplot"><span class="std std-numref">Figure 5.1</span></a> so that:</p>
<ol class="arabic simple">
<li><p>same <code class="docutils literal notranslate"><span class="pre">dose</span></code>s are grouped together (more space between different
<code class="docutils literal notranslate"><span class="pre">dose</span></code>s added; also, on the x-axis, only <em>unique</em> <code class="docutils literal notranslate"><span class="pre">dose</span></code>s are printed),</p></li>
<li><p>different <code class="docutils literal notranslate"><span class="pre">supp</span></code>s have different colours (add a legend explaining them).</p></li>
</ol>
</div></div><div class="proof proof-type-exercise" id="id79">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.39</span>
        
    </div><div class="proof-content">
<p>Write a function for drawing box plots using graphics primitives.</p>
</div></div><div class="proof proof-type-exercise" id="id80">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.40</span>
        
    </div><div class="proof-content">
<p>(*) Write a function for drawing violin plots.
They are similar to box plots but use kernel density estimators.</p>
</div></div><div class="proof proof-type-exercise" id="id81">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.41</span>
        
    </div><div class="proof-content">
<p>(*) Implement a bag plot, which is a two-dimensional version
of a box plot. Use <strong class="command">chull</strong> to compute the convex hull
of a point set.</p>
</div></div></section>
<section id="contour-plots-and-heat-maps">
<span id="sec-heat-map"></span><h3><span class="section-number">13.3.4. </span>Contour plots and heat maps<a class="headerlink" href="#contour-plots-and-heat-maps" title="Permalink to this heading">#</a></h3>
<p>When plotting a function of two variables like <span class="math">\(z=f(x, y)\)</span>,
the magnitude of the <span class="math">\(z\)</span> component can be expressed using colour
brightness or hue.</p>
<p><strong class="command">image</strong> is a convenient wrapper around <strong class="command">rasterImage</strong>,
which can draw contour plots, two-dimensional histograms, heatmaps, etc.</p>
<div class="proof proof-type-example" id="id82">

    <div class="proof-title">
        <span class="proof-type">Example 13.42</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-contour"><span class="std std-numref">Figure 13.27</span></a> presents a filled contour plot
of Himmelblau’s function, <span class="math">\(f(x,y)=(x^{2}+y-11)^{2}+(x+y^{2}-7)^{2}\)</span>,
for <span class="math">\(x\in[-5, 5]\)</span> and <span class="math">\(y\in[-4, 4]\)</span>.
A call to <strong class="command">contour</strong> adds labelled contour lines
(which is actually a nontrivial operation).</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-5</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">250</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">200</span><span class="p">)</span>
<span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span><span class="w"> </span><span class="n">yg</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">xg</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">yg</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">11</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">xg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">yg</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">7</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="nf">image</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="nf">grey</span><span class="p">(</span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">16</span><span class="p">)))</span>
<span class="nf">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">nlevels</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id83">
<span id="fig-contour"></span><img alt="../_images/contour-1.png" src="../_images/contour-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.27 </span><span class="caption-text">A filled contour plot with labelled contour lines.</span><a class="headerlink" href="#id83" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><p>In <strong class="command">image</strong>, the number of rows in <code class="docutils literal notranslate"><span class="pre">z</span></code> matches the length of <code class="docutils literal notranslate"><span class="pre">x</span></code>,
whereas the number of columns is equal to the size of <code class="docutils literal notranslate"><span class="pre">y</span></code>.
This might be counterintuitive; if <code class="docutils literal notranslate"><span class="pre">z</span></code> is printed,
the image is its 90-degree rotated version.</p>
<div class="proof proof-type-example" id="id84">

    <div class="proof-title">
        <span class="proof-type">Example 13.43</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-corr-heatmap"><span class="std std-numref">Figure 13.28</span></a> presents an example heatmap
depicting Pearson’s correlations between all pairs of variables
in the <code class="docutils literal notranslate"><span class="pre">nhanes</span></code> data frame which we loaded some time ago.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">o</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">  </span><span class="c1"># order of rows/cols (by similarity)</span>
<span class="n">R</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">nhanes</span><span class="p">[</span><span class="n">o</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">])</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2.8</span><span class="p">,</span><span class="w"> </span><span class="m">7.6</span><span class="p">,</span><span class="w"> </span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="m">7.6</span><span class="p">),</span><span class="w"> </span><span class="n">ann</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">image</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">NROW</span><span class="p">(</span><span class="n">R</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">NCOL</span><span class="p">(</span><span class="n">R</span><span class="p">),</span><span class="w"> </span><span class="n">R</span><span class="p">,</span>
<span class="w">    </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">NROW</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="m">+0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">    </span><span class="n">zlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="nf">hcl.colors</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BluGrn&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rev</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="w">    </span><span class="n">xlab</span><span class="o">=</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">asp</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">axes</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="nf">NROW</span><span class="p">(</span><span class="n">R</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">dimnames</span><span class="p">(</span><span class="n">R</span><span class="p">)[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">las</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">tick</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">axis</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="nf">NCOL</span><span class="p">(</span><span class="n">R</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">dimnames</span><span class="p">(</span><span class="n">R</span><span class="p">)[[</span><span class="m">2</span><span class="p">]],</span><span class="w"> </span><span class="n">las</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">tick</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="nf">arrayInd</span><span class="p">(</span><span class="nf">seq_along</span><span class="p">(</span><span class="n">R</span><span class="p">),</span><span class="w"> </span><span class="nf">dim</span><span class="p">(</span><span class="n">R</span><span class="p">)),</span>
<span class="w">    </span><span class="n">labels</span><span class="o">=</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%.2f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">),</span>
<span class="w">    </span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)[</span><span class="nf">abs</span><span class="p">(</span><span class="n">R</span><span class="o">&lt;</span><span class="m">0.8</span><span class="p">)</span><span class="m">+1</span><span class="p">],</span>
<span class="w">    </span><span class="n">cex</span><span class="o">=</span><span class="m">0.89</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id85">
<span id="fig-corr-heatmap"></span><img alt="../_images/corr-heatmap-1.png" src="../_images/corr-heatmap-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.28 </span><span class="caption-text">A correlation heatmap drawn using <strong class="command">image</strong>.</span><a class="headerlink" href="#id85" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-exercise" id="id86">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.44</span>
        
    </div><div class="proof-content">
<p>Check out the <strong class="command">heatmap</strong> function,
which uses hierarchical clustering to find an aesthetic reordering of the
matrix’s items.</p>
</div></div><div class="proof proof-type-example" id="id87">

    <div class="proof-title">
        <span class="proof-type">Example 13.45</span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="#fig-colour-density2d"><span class="std std-numref">Figure 13.29</span></a> depicts a two-dimensional histogram.
It approaches the idea of reflecting the points’ density
quite differently from the semi-transparent symbols in
<a class="reference internal" href="#fig-semitrans-scatter"><span class="std std-numref">Figure 13.18</span></a>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">histogram_2d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">breaksx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="n">fx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">breaksx</span><span class="p">,</span><span class="w"> </span><span class="n">include.lowest</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">    </span><span class="n">breaksy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="n">fy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">breaksy</span><span class="p">,</span><span class="w"> </span><span class="n">include.lowest</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span><span class="w"> </span><span class="n">fy</span><span class="p">)</span>
<span class="w">    </span><span class="nf">image</span><span class="p">(</span><span class="nf">midpoints</span><span class="p">(</span><span class="n">breaksx</span><span class="p">),</span><span class="w"> </span><span class="nf">midpoints</span><span class="p">(</span><span class="n">breaksy</span><span class="p">),</span><span class="w"> </span><span class="n">C</span><span class="p">,</span>
<span class="w">        </span><span class="n">xaxs</span><span class="o">=</span><span class="s">&quot;r&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yaxs</span><span class="o">=</span><span class="s">&quot;r&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>
<span class="nf">for </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="m">50</span><span class="p">))</span>
<span class="w">    </span><span class="nf">histogram_2d</span><span class="p">(</span><span class="n">nhanes</span><span class="p">[[</span><span class="s">&quot;height&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">nhanes</span><span class="p">[[</span><span class="s">&quot;weight&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
<span class="w">        </span><span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Height&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Weight&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;#ffffff00&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">hcl.colors</span><span class="p">(</span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Viridis&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rev</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
<span class="w">    </span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id88">
<span id="fig-colour-density2d"></span><img alt="../_images/colour-density2d-1.png" src="../_images/colour-density2d-1.png" />
<figcaption>
<p><span class="caption-number">Figure 13.29 </span><span class="caption-text">Two-dimensional histograms with different numbers of bins, where the bin count is reflected by the colour.</span><a class="headerlink" href="#id88" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div></div><div class="proof proof-type-exercise" id="id89">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.46</span>
        
    </div><div class="proof-content">
<p>(*) Implement some two-dimensional kernel density estimator
and plot it using <strong class="command">contour</strong>.</p>
</div></div></section>
</section>
<section id="exercises">
<h2><span class="section-number">13.4. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<div class="proof proof-type-exercise" id="id90">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.47</span>
        
    </div><div class="proof-content">
<p>Answer the following questions.</p>
<ul class="simple">
<li><p>Can functions from the <strong class="program">graphics</strong> package be used to adjust
the plots generated by <strong class="program">lattice</strong> and <strong class="program">ggplot2</strong>?</p></li>
<li><p>What are the most common graphics primitives?</p></li>
<li><p>Can all high-level functions be implemented using low-level ones?
As an example, discuss the key ingredients used in <strong class="command">barplot</strong>.</p></li>
<li><p>Some high-level functions discussed in this chapter
carry the <code class="docutils literal notranslate"><span class="pre">add</span></code> parameter. What is its purpose?</p></li>
<li><p>What are the admissible values of <code class="docutils literal notranslate"><span class="pre">pch</span></code> and <code class="docutils literal notranslate"><span class="pre">lty</span></code>?
Also, in the default palette, what is the meaning of colours
<code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, …, <code class="docutils literal notranslate"><span class="pre">16</span></code>? Can their meaning be changed?</p></li>
<li><p>Can all graphics parameters be changed?</p></li>
<li><p>What is the difference between passing <code class="docutils literal notranslate"><span class="pre">xaxt=&quot;n&quot;</span></code> to
<strong class="command">plot.default</strong> vs setting it with <strong class="command">par</strong>,
and then calling <strong class="command">plot.default</strong>?</p></li>
<li><p>Which graphics parameters are set by <strong class="command">plot.window</strong>?</p></li>
<li><p>What is the meaning of the <code class="docutils literal notranslate"><span class="pre">usr</span></code> parameter when using the logarithmic
scale on the x-axis?</p></li>
<li><p>(*) How to place a plotting symbol exactly 1 centimetre from
the top-left corner
of the current page (following the page’s diagonal)?</p></li>
<li><p>Semi-transparent polygons are nice, right?</p></li>
<li><p>Can an ellipse be drawn using <strong class="command">polygon</strong>?</p></li>
<li><p>What happens when we set the graphics parameter
<code class="docutils literal notranslate"><span class="pre">mfrow=</span></code><strong class="command">c</strong><code class="code docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>?</p></li>
<li><p>How to export the current plot to a PDF file?</p></li>
</ul>
</div></div><div class="proof proof-type-exercise" id="id91">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.48</span>
        
    </div><div class="proof-content">
<p>Draw the 2022 <a class="reference external" href="https://github.com/gagolews/teaching-data/raw/master/marek/btcusd_close_2022.csv">BTC-to-USD close rates</a>
time series. Then, add the 7- and 30-day moving averages.
(*) Also, fit a local polynomial (moving) regression model
using the Savitzky–Golay filter (see <strong class="command">loess</strong>).</p>
</div></div><div class="proof proof-type-exercise" id="id92">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.49</span>
        
    </div><div class="proof-content">
<p>(*) Draw (from scratch) a candlestick plot
for the 2022 <a class="reference external" href="https://github.com/gagolews/teaching-data/raw/master/marek/btcusd_ohlc_2022.csv">BTC-to-USD rates</a>.</p>
</div></div><div class="proof proof-type-exercise" id="id93">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.50</span>
        
    </div><div class="proof-content">
<p>(*) Create a function to draw a normal quantile-quantile (Q-Q) plot,
i.e., for inspecting whether a numeric sample might come from some normal
distribution.</p>
</div></div><div class="proof proof-type-exercise" id="id94">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.51</span>
        
    </div><div class="proof-content">
<p>(*) Draw a map of the world, where each country
is filled with a colour whose brightness or hue is linked
to its Gini index of income inequality.
You can easily find the data on Wikipedia.
Try to find an open dataset that gives the borders of each country
as vertices of a polygon (e.g., in the form of a (geo)JSON file).</p>
</div></div><div class="proof proof-type-exercise" id="id95">

    <div class="proof-title">
        <span class="proof-type">Exercise 13.52</span>
        
    </div><div class="proof-content">
<p>Next time you see a pleasant data visualisation somewhere,
try to reproduce it using base <strong class="program">graphics</strong>.</p>
</div></div><div style="margin-top: 1em"></div><p>For further information on graphics generation in R,
see, e.g., Chapter 12 of <span id="id11">[<a class="reference internal" href="999-bibliography.html#id9" title="Venables, W.N., Smith, D.M., and R Development Core Team. (2023).  An Introduction to R. URL: https://CRAN.R-project.org/doc/manuals/r-release/R-intro.html.">57</a>]</span>, <span id="id12">[<a class="reference internal" href="999-bibliography.html#id44" title="Murrell, P. (2011).  R Graphics. Chapman &amp; Hall/CRC.">48</a>]</span>,
and <span id="id13">[<a class="reference internal" href="999-bibliography.html#id54" title="Rahlf, T. (2019).  Data Visualisation with R: 111 Examples. Springer Nature, 2nd edition. URL: http://www.datavisualisation-r.com/.">52</a>]</span>.
In this chapter, we were only interested in <em>static</em> graphics,
e.g., for use in printed publications or plain websites.
Interactive plots that a user might tinker with in a web browser
are a different story.</p>
<div style="margin-top: 1em"></div><p>And so the second part of our mind-blowing course is ended.</p>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="pardefexcept" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">1</a><span class="fn-bracket">]</span></span>
<p>Alas, it is not as straightforward as that.
For instance, <strong class="command">polygon</strong> is unaffected by the <code class="docutils literal notranslate"><span class="pre">col</span></code> setting,
<strong class="command">axis</strong> uses <code class="docutils literal notranslate"><span class="pre">col.axis</span></code> instead, etc.
We should always consult the documentation.</p>
</aside>
<aside class="footnote brackets" id="footrgb" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">2</a><span class="fn-bracket">]</span></span>
<p>From school, we probably know the
<em>subtractive</em> CMY (cyan, magenta, yellow) model, where
we obtain, e.g., a green colour by using blue-ish and yellow crayons
(subtracting certain wavelengths from white light).
The RGB model, on the other hand, corresponds to the three
photoreceptor/cone cells in the retinas of the human eyes.
Nonetheless, it is <em>additive</em> and, therefore, less intuitive:
total darkness emerges when we emit no light,
yellow emerges when mixing red and green beams, etc.</p>
</aside>
<aside class="footnote brackets" id="footcolourblind" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">3</a><span class="fn-bracket">]</span></span>
<p>Actually, red-ish, green-ish, etc.
The choice is more aesthetic than when pure red, green, etc.
was used (before R 4.0.0). It is also expected to be more
friendly to people who have some colour vision deficiencies.
We know that roughly every 1 in 12 men (8%) and 1 in 200 women (0.5%),
especially in the red-green or blue-yellow spectrum;
see <span id="id14">[<a class="reference internal" href="999-bibliography.html#id5" title="Okabe, M. and Ito, K. (2002).  Color Universal Design (CUD): How to make figures and presentations that are friendly to Colorblind people. URL: https://jfly.uni-koeln.de/color.">50</a>]</span> for more details.</p>
</aside>
<aside class="footnote brackets" id="footbwonline" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">4</a><span class="fn-bracket">]</span></span>
<p>The readers of the printed version of this book
should know that its online version displays this figure
(and all others) in full colour. See you there.</p>
</aside>
</aside>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="310-compiled.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">14. </span>Interfacing compiled code (**)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="240-data-frame.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">12. </span>Data frames</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              
              
              Copyright &#169; 2022–2023 by <a href="https://www.gagolewski.com">Marek Gagolewski</a>.
              Some rights reserved. Licensed under <a href='https://creativecommons.org/licenses/by-nc-nd/4.0/'>CC BY-NC-ND 4.0</a>.
              Built with <a href="https://sphinx-doc.org/">Sphinx</a>
              and a customised <a href="https://github.com/pradyunsg/furo">Furo</a> theme.
              Last updated on 2023-06-26T22:01:39+1000.
              This site will never display any ads: it is a non-profit project.
              It does not collect any data.
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            In this chapter
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">13. Graphics</a><ul>
<li><a class="reference internal" href="#graphics-primitives">13.1. Graphics primitives</a><ul>
<li><a class="reference internal" href="#symbols-points">13.1.1. Symbols (points)</a></li>
<li><a class="reference internal" href="#line-segments">13.1.2. Line segments</a></li>
<li><a class="reference internal" href="#polygons">13.1.3. Polygons</a></li>
<li><a class="reference internal" href="#text">13.1.4. Text</a></li>
<li><a class="reference internal" href="#raster-images-bitmaps">13.1.5. Raster images (bitmaps) (*)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphics-settings">13.2. Graphics settings</a><ul>
<li><a class="reference internal" href="#colours">13.2.1. Colours</a></li>
<li><a class="reference internal" href="#plot-margins-and-clipping-regions">13.2.2. Plot margins and clipping regions</a></li>
<li><a class="reference internal" href="#user-coordinates-and-axes">13.2.3. User coordinates and axes</a></li>
<li><a class="reference internal" href="#plot-dimensions">13.2.4. Plot dimensions (*)</a></li>
<li><a class="reference internal" href="#many-figures-on-one-page-subplots">13.2.5. Many figures on one page (subplots)</a></li>
<li><a class="reference internal" href="#graphics-devices">13.2.6. Graphics devices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#higher-level-functions">13.3. Higher-level functions</a><ul>
<li><a class="reference internal" href="#scatter-and-function-plots-with-plot-default-and-matplot">13.3.1. Scatter and function plots with <strong class="command">plot.default</strong> and <strong class="command">matplot</strong></a></li>
<li><a class="reference internal" href="#bar-plots-and-histograms">13.3.2. Bar plots and histograms</a></li>
<li><a class="reference internal" href="#box-and-whisker-plots">13.3.3. Box-and-whisker plots</a></li>
<li><a class="reference internal" href="#contour-plots-and-heat-maps">13.3.4. Contour plots and heat maps</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercises">13.4. Exercises</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/proof.js"></script>
    <script src="../_static/katex.min.js"></script>
    <script src="../_static/auto-render.min.js"></script>
    <script src="../_static/katex_autorenderer.js"></script>
    </body>
</html>